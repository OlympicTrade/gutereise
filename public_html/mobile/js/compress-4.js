;var libs={jquery:'//ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js',jqueryUi:'//ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js',libYandexMaps:'//api-maps.yandex.ru/2.1/?lang=ru_RU',libVkOpenApi:'//vk.com/js/api/openapi.js',libFancybox:'lib/fancybox/fansybox.js',libHistory:'lib/history.js',libFancyboxThumb:'lib/fancybox/thumbs.js',libFancyboxMedia:'lib/fancybox/media.js',libFlexSlider:'lib/flexslider.js',libOwlSlider:'lib/owlslider.js',libAptero:'lib/aptero.js',libFormValidator:'lib/form-validator.js',mouseWheeel:'lib/mousewheel.js',libSmoothScroll:'lib/smoothscroll.js',libNiceScroll:'lib/nicescroll.js',libInputMask:'lib/inputmask.js',libCookie:'lib/cookie.js',libCart:'lib/cart.js',libProductsList:'lib/products-list.js',};$.config={};(function(window,document,$,undefined){'use strict';window.console=window.console||{info:function(stuff){}};if(!$){return};if($.fn.fancybox){console.info('fancyBox already initialized');return};var defaults={closeExisting:false,loop:false,gutter:50,keyboard:true,preventCaptionOverlap:true,arrows:true,infobar:true,smallBtn:'auto',toolbar:'auto',buttons:['zoom','slideShow','thumbs','close'],idleTime:3,protect:false,modal:false,image:{preload:false},ajax:{settings:{data:{fancybox:true}}},iframe:{tpl:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" allowfullscreen allow="autoplay; fullscreen" src=""></iframe>',preload:true,css:{},attr:{scrolling:'auto'}},video:{tpl:'<video class="fancybox-video" controls controlsList="nodownload" poster="{{poster}}"><source src="{{src}}" type="{{format}}" />Sorry, your browser doesn\'t support embedded videos, <a href="{{src}}">download</a> and watch with your favorite video player!</video>',format:'',autoStart:true},defaultType:'image',animationEffect:'zoom',animationDuration:366,zoomOpacity:'auto',transitionEffect:'fade',transitionDuration:366,slideClass:'',baseClass:'',baseTpl:'<div class="fancybox-container" role="dialog" tabindex="-1"><div class="fancybox-bg"></div><div class="fancybox-inner"><div class="fancybox-infobar"><span data-fancybox-index></span>&nbsp;/&nbsp;<span data-fancybox-count></span></div><div class="fancybox-toolbar">{{buttons}}</div><div class="fancybox-navigation">{{arrows}}</div><div class="fancybox-stage"></div><div class="fancybox-caption"></div></div></div>',spinnerTpl:'<div class="fancybox-loading"></div>',errorTpl:'<div class="fancybox-error"><p>{{ERROR}}</p></div>',btnTpl:{download:'<a download data-fancybox-download class="fancybox-button fancybox-button--download" title="{{DOWNLOAD}}" href="javascript:;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.62 17.09V19H5.38v-1.91zm-2.97-6.96L17 11.45l-5 4.87-5-4.87 1.36-1.32 2.68 2.64V5h1.92v7.77z"/></svg></a>',zoom:'<button data-fancybox-zoom class="fancybox-button fancybox-button--zoom" title="{{ZOOM}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.7 17.3l-3-3a5.9 5.9 0 0 0-.6-7.6 5.9 5.9 0 0 0-8.4 0 5.9 5.9 0 0 0 0 8.4 5.9 5.9 0 0 0 7.7.7l3 3a1 1 0 0 0 1.3 0c.4-.5.4-1 0-1.5zM8.1 13.8a4 4 0 0 1 0-5.7 4 4 0 0 1 5.7 0 4 4 0 0 1 0 5.7 4 4 0 0 1-5.7 0z"/></svg></button>',close:'<button data-fancybox-close class="fancybox-button fancybox-button--close" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 10.6L6.6 5.2 5.2 6.6l5.4 5.4-5.4 5.4 1.4 1.4 5.4-5.4 5.4 5.4 1.4-1.4-5.4-5.4 5.4-5.4-1.4-1.4-5.4 5.4z"/></svg></button>',arrowLeft:'<button data-fancybox-prev class="fancybox-button fancybox-button--arrow_left" title="{{PREV}}"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.28 15.7l-1.34 1.37L5 12l4.94-5.07 1.34 1.38-2.68 2.72H19v1.94H8.6z"/></svg></div></button>',arrowRight:'<button data-fancybox-next class="fancybox-button fancybox-button--arrow_right" title="{{NEXT}}"><div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.4 12.97l-2.68 2.72 1.34 1.38L19 12l-4.94-5.07-1.34 1.38 2.68 2.72H5v1.94z"/></svg></div></button>',smallBtn:'<button type="button" data-fancybox-close class="fancybox-button fancybox-close-small" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 24 24"><path d="M13 12l5-5-1-1-5 5-5-5-1 1 5 5-5 5 1 1 5-5 5 5 1-1z"/></svg></button>'},parentEl:'body',hideScrollbar:true,autoFocus:true,backFocus:true,trapFocus:true,fullScreen:{autoStart:false},touch:{vertical:true,momentum:true},hash:null,media:{},slideShow:{autoStart:false,speed:3000},thumbs:{autoStart:false,hideOnClose:true,parentEl:'.fancybox-container',axis:'y'},wheel:'auto',onInit:$.noop,beforeLoad:$.noop,afterLoad:$.noop,beforeShow:$.noop,afterShow:$.noop,beforeClose:$.noop,afterClose:$.noop,onActivate:$.noop,onDeactivate:$.noop,clickContent:function(current,event){return current.type==='image'?'zoom':false},clickSlide:'close',clickOutside:'close',dblclickContent:false,dblclickSlide:false,dblclickOutside:false,mobile:{preventCaptionOverlap:false,idleTime:false,clickContent:function(current,event){return current.type==='image'?'toggleControls':false},clickSlide:function(current,event){return current.type==='image'?'toggleControls':'close'},dblclickContent:function(current,event){return current.type==='image'?'zoom':false},dblclickSlide:function(current,event){return current.type==='image'?'zoom':false}},lang:'en',i18n:{en:{CLOSE:'Close',NEXT:'Next',PREV:'Previous',ERROR:'The requested content cannot be loaded. <br/> Please try again later.',PLAY_START:'Start slideshow',PLAY_STOP:'Pause slideshow',FULL_SCREEN:'Full screen',THUMBS:'Thumbnails',DOWNLOAD:'Download',SHARE:'Share',ZOOM:'Zoom'},de:{CLOSE:'Schliessen',NEXT:'Weiter',PREV:'Zurück',ERROR:'Die angeforderten Daten konnten nicht geladen werden. <br/> Bitte versuchen Sie es später nochmal.',PLAY_START:'Diaschau starten',PLAY_STOP:'Diaschau beenden',FULL_SCREEN:'Vollbild',THUMBS:'Vorschaubilder',DOWNLOAD:'Herunterladen',SHARE:'Teilen',ZOOM:'Maßstab'}}};var $W=$(window),$D=$(document),called=0,isQuery=function(obj){return obj&&obj.hasOwnProperty&&obj instanceof $},requestAFrame=(function(){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(callback){return window.setTimeout(callback,1000/60)})})(),cancelAFrame=(function(){return(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||function(id){window.clearTimeout(id)})})(),transitionEnd=(function(){var el=document.createElement('fakeelement'),t,transitions={transition:'transitionend',OTransition:'oTransitionEnd',MozTransition:'transitionend',WebkitTransition:'webkitTransitionEnd'};for(t in transitions){if(el.style[t]!==undefined){return transitions[t]}};return'transitionend'})(),forceRedraw=function($el){return $el&&$el.length&&$el[0].offsetHeight},mergeOpts=function(opts1,opts2){var rez=$.extend(true,{},opts1,opts2);$.each(opts2,function(key,value){if($.isArray(value)){rez[key]=value}});return rez},inViewport=function(elem){var elemCenter,rez;if(!elem||elem.ownerDocument!==document){return false};$('.fancybox-container').css('pointer-events','none');elemCenter={x:elem.getBoundingClientRect().left+elem.offsetWidth/2,y:elem.getBoundingClientRect().top+elem.offsetHeight/2};rez=document.elementFromPoint(elemCenter.x,elemCenter.y)===elem;$('.fancybox-container').css('pointer-events','');return rez},FancyBox=function(content,opts,index){var self=this;self.opts=mergeOpts({index:index},$.fancybox.defaults);if($.isPlainObject(opts)){self.opts=mergeOpts(self.opts,opts)};if($.fancybox.isMobile){self.opts=mergeOpts(self.opts,self.opts.mobile)};self.id=self.opts.id||++called;self.currIndex=parseInt(self.opts.index,10)||0;self.prevIndex=null;self.prevPos=null;self.currPos=0;self.firstRun=true;self.group=[];self.slides={};self.addContent(content);if(!self.group.length){return};self.init()};$.extend(FancyBox.prototype,{init:function(){var self=this,firstItem=self.group[self.currIndex],firstItemOpts=firstItem.opts,$container,buttonStr;if(firstItemOpts.closeExisting){$.fancybox.close(true)};$('body').addClass('fancybox-active');if(!$.fancybox.getInstance()&&firstItemOpts.hideScrollbar!==false&&!$.fancybox.isMobile&&document.body.scrollHeight>window.innerHeight){$('head').append('<style id="fancybox-style-noscroll" type="text/css">.compensate-for-scrollbar{margin-right:'+(window.innerWidth-document.documentElement.clientWidth)+'px;}</style>');$('body').addClass('compensate-for-scrollbar')};buttonStr='';$.each(firstItemOpts.buttons,function(index,value){buttonStr+=firstItemOpts.btnTpl[value]||''});$container=$(self.translate(self,firstItemOpts.baseTpl.replace('{{buttons}}',buttonStr).replace('{{arrows}}',firstItemOpts.btnTpl.arrowLeft+firstItemOpts.btnTpl.arrowRight))).attr('id','fancybox-container-'+self.id).addClass(firstItemOpts.baseClass).data('FancyBox',self).appendTo(firstItemOpts.parentEl);self.$refs={container:$container};['bg','inner','infobar','toolbar','stage','caption','navigation'].forEach(function(item){self.$refs[item]=$container.find('.fancybox-'+item)});self.trigger('onInit');self.activate();self.jumpTo(self.currIndex)},translate:function(obj,str){var arr=obj.opts.i18n[obj.opts.lang]||obj.opts.i18n.en;return str.replace(/\{\{(\w+)\}\}/g,function(match,n){var value=arr[n];if(value===undefined){return match};return value})},addContent:function(content){var self=this,items=$.makeArray(content),thumbs;$.each(items,function(i,item){var obj={},opts={},$item,type,found,src,srcParts;if($.isPlainObject(item)){obj=item;opts=item.opts||item}else if($.type(item)==='object'&&$(item).length){$item=$(item);opts=$item.data()||{};opts=$.extend(true,{},opts,opts.options);opts.$orig=$item;obj.src=self.opts.src||opts.src||$item.attr('href');if(!obj.type&&!obj.src){obj.type='inline';obj.src=item}}else{obj={type:'html',src:item+''}};obj.opts=$.extend(true,{},self.opts,opts);if($.isArray(opts.buttons)){obj.opts.buttons=opts.buttons};if($.fancybox.isMobile&&obj.opts.mobile){obj.opts=mergeOpts(obj.opts,obj.opts.mobile)};type=obj.type||obj.opts.type;src=obj.src||'';if(!type&&src){if((found=src.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))){type='video';if(!obj.opts.video.format){obj.opts.video.format='video/'+(found[1]==='ogv'?'ogg':found[1])}}else if(src.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)){type='image'}else if(src.match(/\.(pdf)((\?|#).*)?$/i)){type='iframe';obj=$.extend(true,obj,{contentType:'pdf',opts:{iframe:{preload:false}}})}else if(src.charAt(0)==='#'){type='inline'}};if(type){obj.type=type}else{self.trigger('objectNeedsType',obj)};if(!obj.contentType){obj.contentType=$.inArray(obj.type,['html','inline','ajax'])>-1?'html':obj.type};obj.index=self.group.length;if(obj.opts.smallBtn=='auto'){obj.opts.smallBtn=$.inArray(obj.type,['html','inline','ajax'])>-1};if(obj.opts.toolbar==='auto'){obj.opts.toolbar=!obj.opts.smallBtn};obj.$thumb=obj.opts.$thumb||null;if(obj.opts.$trigger&&obj.index===self.opts.index){obj.$thumb=obj.opts.$trigger.find('img:first');if(obj.$thumb.length){obj.opts.$orig=obj.opts.$trigger}};if(!(obj.$thumb&&obj.$thumb.length)&&obj.opts.$orig){obj.$thumb=obj.opts.$orig.find('img:first')};if(obj.$thumb&&!obj.$thumb.length){obj.$thumb=null};obj.thumb=obj.opts.thumb||(obj.$thumb?obj.$thumb[0].src:null);if($.type(obj.opts.caption)==='function'){obj.opts.caption=obj.opts.caption.apply(item,[self,obj])};if($.type(self.opts.caption)==='function'){obj.opts.caption=self.opts.caption.apply(item,[self,obj])};if(!(obj.opts.caption instanceof $)){obj.opts.caption=obj.opts.caption===undefined?'':obj.opts.caption+''};if(obj.type==='ajax'){srcParts=src.split(/\s+/,2);if(srcParts.length>1){obj.src=srcParts.shift();obj.opts.filter=srcParts.shift()}};if(obj.opts.modal){obj.opts=$.extend(true,obj.opts,{trapFocus:true,infobar:0,toolbar:0,smallBtn:0,keyboard:0,slideShow:0,fullScreen:0,thumbs:0,touch:0,clickContent:false,clickSlide:false,clickOutside:false,dblclickContent:false,dblclickSlide:false,dblclickOutside:false})};self.group.push(obj)});if(Object.keys(self.slides).length){self.updateControls();thumbs=self.Thumbs;if(thumbs&&thumbs.isActive){thumbs.create();thumbs.focus()}}},addEvents:function(){var self=this;self.removeEvents();self.$refs.container.on('click.fb-close','[data-fancybox-close]',function(e){e.stopPropagation();e.preventDefault();self.close(e)}).on('touchstart.fb-prev click.fb-prev','[data-fancybox-prev]',function(e){e.stopPropagation();e.preventDefault();self.previous()}).on('touchstart.fb-next click.fb-next','[data-fancybox-next]',function(e){e.stopPropagation();e.preventDefault();self.next()}).on('click.fb','[data-fancybox-zoom]',function(e){self[self.isScaledDown()?'scaleToActual':'scaleToFit']()});$W.on('orientationchange.fb resize.fb',function(e){if(e&&e.originalEvent&&e.originalEvent.type==='resize'){if(self.requestId){cancelAFrame(self.requestId)};self.requestId=requestAFrame(function(){self.update(e)})}else{if(self.current&&self.current.type==='iframe'){self.$refs.stage.hide()};setTimeout(function(){self.$refs.stage.show();self.update(e)},$.fancybox.isMobile?600:250)}});$D.on('keydown.fb',function(e){var instance=$.fancybox?$.fancybox.getInstance():null,current=instance.current,keycode=e.keyCode||e.which;if(keycode==9){if(current.opts.trapFocus){self.focus(e)};return};if(!current.opts.keyboard||e.ctrlKey||e.altKey||e.shiftKey||$(e.target).is('input')||$(e.target).is('textarea')){return};if(keycode===8||keycode===27){e.preventDefault();self.close(e);return};if(keycode===37||keycode===38){e.preventDefault();self.previous();return};if(keycode===39||keycode===40){e.preventDefault();self.next();return};self.trigger('afterKeydown',e,keycode)});if(self.group[self.currIndex].opts.idleTime){self.idleSecondsCounter=0;$D.on('mousemove.fb-idle mouseleave.fb-idle mousedown.fb-idle touchstart.fb-idle touchmove.fb-idle scroll.fb-idle keydown.fb-idle',function(e){self.idleSecondsCounter=0;if(self.isIdle){self.showControls()};self.isIdle=false});self.idleInterval=window.setInterval(function(){self.idleSecondsCounter++;if(self.idleSecondsCounter>=self.group[self.currIndex].opts.idleTime&&!self.isDragging){self.isIdle=true;self.idleSecondsCounter=0;self.hideControls()}},1000)}},removeEvents:function(){var self=this;$W.off('orientationchange.fb resize.fb');$D.off('keydown.fb .fb-idle');this.$refs.container.off('.fb-close .fb-prev .fb-next');if(self.idleInterval){window.clearInterval(self.idleInterval);self.idleInterval=null}},previous:function(duration){return this.jumpTo(this.currPos-1,duration)},next:function(duration){return this.jumpTo(this.currPos+1,duration)},jumpTo:function(pos,duration){var self=this,groupLen=self.group.length,firstRun,isMoved,loop,current,previous,slidePos,stagePos,prop,diff;if(self.isDragging||self.isClosing||(self.isAnimating&&self.firstRun)){return};pos=parseInt(pos,10);loop=self.current?self.current.opts.loop:self.opts.loop;if(!loop&&(pos<0||pos>=groupLen)){return false};firstRun=self.firstRun=!Object.keys(self.slides).length;previous=self.current;self.prevIndex=self.currIndex;self.prevPos=self.currPos;current=self.createSlide(pos);if(groupLen>1){if(loop||current.index<groupLen-1){self.createSlide(pos+1)};if(loop||current.index>0){self.createSlide(pos-1)}};self.current=current;self.currIndex=current.index;self.currPos=current.pos;self.trigger('beforeShow',firstRun);self.updateControls();current.forcedDuration=undefined;if($.isNumeric(duration)){current.forcedDuration=duration}else{duration=current.opts[firstRun?'animationDuration':'transitionDuration']};duration=parseInt(duration,10);isMoved=self.isMoved(current);current.$slide.addClass('fancybox-slide--current');if(firstRun){if(current.opts.animationEffect&&duration){self.$refs.container.css('transition-duration',duration+'ms')};self.$refs.container.addClass('fancybox-is-open').trigger('focus');self.loadSlide(current);self.preload('image');return};slidePos=$.fancybox.getTranslate(previous.$slide);stagePos=$.fancybox.getTranslate(self.$refs.stage);$.each(self.slides,function(index,slide){$.fancybox.stop(slide.$slide,true)});if(previous.pos!==current.pos){previous.isComplete=false};previous.$slide.removeClass('fancybox-slide--complete fancybox-slide--current');if(isMoved){diff=slidePos.left-(previous.pos*slidePos.width+previous.pos*previous.opts.gutter);$.each(self.slides,function(index,slide){slide.$slide.removeClass('fancybox-animated').removeClass(function(index,className){return(className.match(/(^|\s)fancybox-fx-\S+/g)||[]).join(' ')});var leftPos=slide.pos*slidePos.width+slide.pos*slide.opts.gutter;$.fancybox.setTranslate(slide.$slide,{top:0,left:leftPos-stagePos.left+diff});if(slide.pos!==current.pos){slide.$slide.addClass('fancybox-slide--'+(slide.pos>current.pos?'next':'previous'))};forceRedraw(slide.$slide);$.fancybox.animate(slide.$slide,{top:0,left:(slide.pos-current.pos)*slidePos.width+(slide.pos-current.pos)*slide.opts.gutter},duration,function(){slide.$slide.css({transform:'',opacity:''}).removeClass('fancybox-slide--next fancybox-slide--previous');if(slide.pos===self.currPos){self.complete()}})})}else if(duration&&current.opts.transitionEffect){prop='fancybox-animated fancybox-fx-'+current.opts.transitionEffect;previous.$slide.addClass('fancybox-slide--'+(previous.pos>current.pos?'next':'previous'));$.fancybox.animate(previous.$slide,prop,duration,function(){previous.$slide.removeClass(prop).removeClass('fancybox-slide--next fancybox-slide--previous')},false)};if(current.isLoaded){self.revealContent(current)}else{self.loadSlide(current)};self.preload('image')},createSlide:function(pos){var self=this,$slide,index;index=pos%self.group.length;index=index<0?self.group.length+index:index;if(!self.slides[pos]&&self.group[index]){$slide=$('<div class="fancybox-slide"></div>').appendTo(self.$refs.stage);self.slides[pos]=$.extend(true,{},self.group[index],{pos:pos,$slide:$slide,isLoaded:false});self.updateSlide(self.slides[pos])};return self.slides[pos]},scaleToActual:function(x,y,duration){var self=this,current=self.current,$content=current.$content,canvasWidth=$.fancybox.getTranslate(current.$slide).width,canvasHeight=$.fancybox.getTranslate(current.$slide).height,newImgWidth=current.width,newImgHeight=current.height,imgPos,posX,posY,scaleX,scaleY;if(self.isAnimating||self.isMoved()||!$content||!(current.type=='image'&&current.isLoaded&&!current.hasError)){return};self.isAnimating=true;$.fancybox.stop($content);x=x===undefined?canvasWidth*0.5:x;y=y===undefined?canvasHeight*0.5:y;imgPos=$.fancybox.getTranslate($content);imgPos.top-=$.fancybox.getTranslate(current.$slide).top;imgPos.left-=$.fancybox.getTranslate(current.$slide).left;scaleX=newImgWidth/imgPos.width;scaleY=newImgHeight/imgPos.height;posX=canvasWidth*0.5-newImgWidth*0.5;posY=canvasHeight*0.5-newImgHeight*0.5;if(newImgWidth>canvasWidth){posX=imgPos.left*scaleX-(x*scaleX-x);if(posX>0){posX=0};if(posX<canvasWidth-newImgWidth){posX=canvasWidth-newImgWidth}};if(newImgHeight>canvasHeight){posY=imgPos.top*scaleY-(y*scaleY-y);if(posY>0){posY=0};if(posY<canvasHeight-newImgHeight){posY=canvasHeight-newImgHeight}};self.updateCursor(newImgWidth,newImgHeight);$.fancybox.animate($content,{top:posY,left:posX,scaleX:scaleX,scaleY:scaleY},duration||330,function(){self.isAnimating=false});if(self.SlideShow&&self.SlideShow.isActive){self.SlideShow.stop()}},scaleToFit:function(duration){var self=this,current=self.current,$content=current.$content,end;if(self.isAnimating||self.isMoved()||!$content||!(current.type=='image'&&current.isLoaded&&!current.hasError)){return};self.isAnimating=true;$.fancybox.stop($content);end=self.getFitPos(current);self.updateCursor(end.width,end.height);$.fancybox.animate($content,{top:end.top,left:end.left,scaleX:end.width/$content.width(),scaleY:end.height/$content.height()},duration||330,function(){self.isAnimating=false})},getFitPos:function(slide){var self=this,$content=slide.$content,$slide=slide.$slide,width=slide.width||slide.opts.width,height=slide.height||slide.opts.height,maxWidth,maxHeight,minRatio,aspectRatio,rez={};if(!slide.isLoaded||!$content||!$content.length){return false};maxWidth=$.fancybox.getTranslate(self.$refs.stage).width;maxHeight=$.fancybox.getTranslate(self.$refs.stage).height;maxWidth-=parseFloat($slide.css('paddingLeft'))+parseFloat($slide.css('paddingRight'))+parseFloat($content.css('marginLeft'))+parseFloat($content.css('marginRight'));maxHeight-=parseFloat($slide.css('paddingTop'))+parseFloat($slide.css('paddingBottom'))+parseFloat($content.css('marginTop'))+parseFloat($content.css('marginBottom'));if(!width||!height){width=maxWidth;height=maxHeight};minRatio=Math.min(1,maxWidth/width,maxHeight/height);width=minRatio*width;height=minRatio*height;if(width>maxWidth-0.5){width=maxWidth};if(height>maxHeight-0.5){height=maxHeight};if(slide.type==='image'){rez.top=Math.floor((maxHeight-height)*0.5)+parseFloat($slide.css('paddingTop'));rez.left=Math.floor((maxWidth-width)*0.5)+parseFloat($slide.css('paddingLeft'))}else if(slide.contentType==='video'){aspectRatio=slide.opts.width&&slide.opts.height?width/height:slide.opts.ratio||16/9;if(height>width/aspectRatio){height=width/aspectRatio}else if(width>height*aspectRatio){width=height*aspectRatio}};rez.width=width;rez.height=height;return rez},update:function(e){var self=this;$.each(self.slides,function(key,slide){self.updateSlide(slide,e)})},updateSlide:function(slide,e){var self=this,$content=slide&&slide.$content,width=slide.width||slide.opts.width,height=slide.height||slide.opts.height,$slide=slide.$slide;self.adjustCaption(slide);if($content&&(width||height||slide.contentType==='video')&&!slide.hasError){$.fancybox.stop($content);$.fancybox.setTranslate($content,self.getFitPos(slide));if(slide.pos===self.currPos){self.isAnimating=false;self.updateCursor()}};self.adjustLayout(slide);if($slide.length){$slide.trigger('refresh');if(slide.pos===self.currPos){self.$refs.toolbar.add(self.$refs.navigation.find('.fancybox-button--arrow_right')).toggleClass('compensate-for-scrollbar',$slide.get(0).scrollHeight>$slide.get(0).clientHeight)}};self.trigger('onUpdate',slide,e)},centerSlide:function(duration){var self=this,current=self.current,$slide=current.$slide;if(self.isClosing||!current){return};$slide.siblings().css({transform:'',opacity:''});$slide.parent().children().removeClass('fancybox-slide--previous fancybox-slide--next');$.fancybox.animate($slide,{top:0,left:0,opacity:1},duration===undefined?0:duration,function(){$slide.css({transform:'',opacity:''});if(!current.isComplete){self.complete()}},false)},isMoved:function(slide){var current=slide||this.current,slidePos,stagePos;if(!current){return false};stagePos=$.fancybox.getTranslate(this.$refs.stage);slidePos=$.fancybox.getTranslate(current.$slide);return(!current.$slide.hasClass('fancybox-animated')&&(Math.abs(slidePos.top-stagePos.top)>0.5||Math.abs(slidePos.left-stagePos.left)>0.5))},updateCursor:function(nextWidth,nextHeight){var self=this,current=self.current,$container=self.$refs.container,canPan,isZoomable;if(!current||self.isClosing||!self.Guestures){return};$container.removeClass('fancybox-is-zoomable fancybox-can-zoomIn fancybox-can-zoomOut fancybox-can-swipe fancybox-can-pan');canPan=self.canPan(nextWidth,nextHeight);isZoomable=canPan?true:self.isZoomable();$container.toggleClass('fancybox-is-zoomable',isZoomable);$('[data-fancybox-zoom]').prop('disabled',!isZoomable);if(canPan){$container.addClass('fancybox-can-pan')}else if(isZoomable&&(current.opts.clickContent==='zoom'||($.isFunction(current.opts.clickContent)&&current.opts.clickContent(current)=='zoom'))){$container.addClass('fancybox-can-zoomIn')}else if(current.opts.touch&&(current.opts.touch.vertical||self.group.length>1)&&current.contentType!=='video'){$container.addClass('fancybox-can-swipe')}},isZoomable:function(){var self=this,current=self.current,fitPos;if(current&&!self.isClosing&&current.type==='image'&&!current.hasError){if(!current.isLoaded){return true};fitPos=self.getFitPos(current);if(fitPos&&(current.width>fitPos.width||current.height>fitPos.height)){return true}};return false},isScaledDown:function(nextWidth,nextHeight){var self=this,rez=false,current=self.current,$content=current.$content;if(nextWidth!==undefined&&nextHeight!==undefined){rez=nextWidth<current.width&&nextHeight<current.height}else if($content){rez=$.fancybox.getTranslate($content);rez=rez.width<current.width&&rez.height<current.height};return rez},canPan:function(nextWidth,nextHeight){var self=this,current=self.current,pos=null,rez=false;if(current.type==='image'&&(current.isComplete||(nextWidth&&nextHeight))&&!current.hasError){rez=self.getFitPos(current);if(nextWidth!==undefined&&nextHeight!==undefined){pos={width:nextWidth,height:nextHeight}}else if(current.isComplete){pos=$.fancybox.getTranslate(current.$content)};if(pos&&rez){rez=Math.abs(pos.width-rez.width)>1.5||Math.abs(pos.height-rez.height)>1.5}};return rez},loadSlide:function(slide){var self=this,type,$slide,ajaxLoad;if(slide.isLoading||slide.isLoaded){return};slide.isLoading=true;if(self.trigger('beforeLoad',slide)===false){slide.isLoading=false;return false};type=slide.type;$slide=slide.$slide;$slide.off('refresh').trigger('onReset').addClass(slide.opts.slideClass);switch(type){case'image':self.setImage(slide);break;case'iframe':self.setIframe(slide);break;case'html':self.setContent(slide,slide.src||slide.content);break;case'video':self.setContent(slide,slide.opts.video.tpl.replace(/\{\{src\}\}/gi,slide.src).replace('{{format}}',slide.opts.videoFormat||slide.opts.video.format||'').replace('{{poster}}',slide.thumb||''));break;case'inline':if($(slide.src).length){self.setContent(slide,$(slide.src))}else{self.setError(slide)};break;case'ajax':self.showLoading(slide);ajaxLoad=$.ajax($.extend({},slide.opts.ajax.settings,{url:slide.src,success:function(data,textStatus){if(textStatus==='success'){self.setContent(slide,data)}},error:function(jqXHR,textStatus){if(jqXHR&&textStatus!=='abort'){self.setError(slide)}}}));$slide.one('onReset',function(){ajaxLoad.abort()});break;default:self.setError(slide);break};return true},setImage:function(slide){var self=this,ghost;setTimeout(function(){var $img=slide.$image;if(!self.isClosing&&slide.isLoading&&(!$img||!$img.length||!$img[0].complete)&&!slide.hasError){self.showLoading(slide)}},50);self.checkSrcset(slide);slide.$content=$('<div class="fancybox-content"></div>').addClass('fancybox-is-hidden').appendTo(slide.$slide.addClass('fancybox-slide--image'));if(slide.opts.preload!==false&&slide.opts.width&&slide.opts.height&&slide.thumb){slide.width=slide.opts.width;slide.height=slide.opts.height;ghost=document.createElement('img');ghost.onerror=function(){$(this).remove();slide.$ghost=null};ghost.onload=function(){self.afterLoad(slide)};slide.$ghost=$(ghost).addClass('fancybox-image').appendTo(slide.$content).attr('src',slide.thumb)};self.setBigImage(slide)},checkSrcset:function(slide){var srcset=slide.opts.srcset||slide.opts.image.srcset,found,temp,pxRatio,windowWidth;if(srcset){pxRatio=window.devicePixelRatio||1;windowWidth=window.innerWidth*pxRatio;temp=srcset.split(',').map(function(el){var ret={};el.trim().split(/\s+/).forEach(function(el,i){var value=parseInt(el.substring(0,el.length-1),10);if(i===0){return(ret.url=el)};if(value){ret.value=value;ret.postfix=el[el.length-1]}});return ret});temp.sort(function(a,b){return a.value-b.value});for(var j=0;j<temp.length;j++){var el=temp[j];if((el.postfix==='w'&&el.value>=windowWidth)||(el.postfix==='x'&&el.value>=pxRatio)){found=el;break}};if(!found&&temp.length){found=temp[temp.length-1]};if(found){slide.src=found.url;if(slide.width&&slide.height&&found.postfix=='w'){slide.height=(slide.width/slide.height)*found.value;slide.width=found.value};slide.opts.srcset=srcset}}},setBigImage:function(slide){var self=this,img=document.createElement('img'),$img=$(img);slide.$image=$img.one('error',function(){self.setError(slide)}).one('load',function(){var sizes;if(!slide.$ghost){self.resolveImageSlideSize(slide,this.naturalWidth,this.naturalHeight);self.afterLoad(slide)};if(self.isClosing){return};if(slide.opts.srcset){sizes=slide.opts.sizes;if(!sizes||sizes==='auto'){sizes=(slide.width/slide.height>1&&$W.width()/$W.height()>1?'100':Math.round((slide.width/slide.height)*100))+'vw'};$img.attr('sizes',sizes).attr('srcset',slide.opts.srcset)};if(slide.$ghost){setTimeout(function(){if(slide.$ghost&&!self.isClosing){slide.$ghost.hide()}},Math.min(300,Math.max(1000,slide.height/1600)))};self.hideLoading(slide)}).addClass('fancybox-image').attr('src',slide.src).appendTo(slide.$content);if((img.complete||img.readyState=='complete')&&$img.naturalWidth&&$img.naturalHeight){$img.trigger('load')}else if(img.error){$img.trigger('error')}},resolveImageSlideSize:function(slide,imgWidth,imgHeight){var maxWidth=parseInt(slide.opts.width,10),maxHeight=parseInt(slide.opts.height,10);slide.width=imgWidth;slide.height=imgHeight;if(maxWidth>0){slide.width=maxWidth;slide.height=Math.floor((maxWidth*imgHeight)/imgWidth)};if(maxHeight>0){slide.width=Math.floor((maxHeight*imgWidth)/imgHeight);slide.height=maxHeight}},setIframe:function(slide){var self=this,opts=slide.opts.iframe,$slide=slide.$slide,$iframe;if($.fancybox.isMobile){opts.css.overflow='scroll'};slide.$content=$('<div class="fancybox-content'+(opts.preload?' fancybox-is-hidden':'')+'"></div>').css(opts.css).appendTo($slide);$slide.addClass('fancybox-slide--'+slide.contentType);slide.$iframe=$iframe=$(opts.tpl.replace(/\{rnd\}/g,new Date().getTime())).attr(opts.attr).appendTo(slide.$content);if(opts.preload){self.showLoading(slide);$iframe.on('load.fb error.fb',function(e){this.isReady=1;slide.$slide.trigger('refresh');self.afterLoad(slide)});$slide.on('refresh.fb',function(){var $content=slide.$content,frameWidth=opts.css.width,frameHeight=opts.css.height,$contents,$body;if($iframe[0].isReady!==1){return};try{$contents=$iframe.contents();$body=$contents.find('body')}catch(catch$scope$var1347216585){};if($body&&$body.length&&$body.children().length){$slide.css('overflow','visible');$content.css({width:'100%','max-width':'100%',height:'9999px'});if(frameWidth===undefined){frameWidth=Math.ceil(Math.max($body[0].clientWidth,$body.outerWidth(true)))};$content.css('width',frameWidth?frameWidth:'').css('max-width','');if(frameHeight===undefined){frameHeight=Math.ceil(Math.max($body[0].clientHeight,$body.outerHeight(true)))};$content.css('height',frameHeight?frameHeight:'');$slide.css('overflow','auto')};$content.removeClass('fancybox-is-hidden')})}else{self.afterLoad(slide)};$iframe.attr('src',slide.src);$slide.one('onReset',function(){try{$(this).find('iframe').hide().unbind().attr('src','//about:blank')}catch(catch$scope$var1347216585){};$(this).off('refresh.fb').empty();slide.isLoaded=false;slide.isRevealed=false})},setContent:function(slide,content){var self=this;if(self.isClosing){return};self.hideLoading(slide);if(slide.$content){$.fancybox.stop(slide.$content)};slide.$slide.empty();if(isQuery(content)&&content.parent().length){if(content.hasClass('fancybox-content')||content.parent().hasClass('fancybox-content')){content.parents('.fancybox-slide').trigger('onReset')};slide.$placeholder=$('<div>').hide().insertAfter(content);content.css('display','inline-block')}else if(!slide.hasError){if($.type(content)==='string'){content=$('<div>').append($.trim(content)).contents()};if(slide.opts.filter){content=$('<div>').html(content).find(slide.opts.filter)}};slide.$slide.one('onReset',function(){$(this).find('video,audio').trigger('pause');if(slide.$placeholder){slide.$placeholder.after(content.removeClass('fancybox-content').hide()).remove();slide.$placeholder=null};if(slide.$smallBtn){slide.$smallBtn.remove();slide.$smallBtn=null};if(!slide.hasError){$(this).empty();slide.isLoaded=false;slide.isRevealed=false}});$(content).appendTo(slide.$slide);if($(content).is('video,audio')){$(content).addClass('fancybox-video');$(content).wrap('<div></div>');slide.contentType='video';slide.opts.width=slide.opts.width||$(content).attr('width');slide.opts.height=slide.opts.height||$(content).attr('height')};slide.$content=slide.$slide.children().filter('div,form,main,video,audio,article,.fancybox-content').first();slide.$content.siblings().hide();if(!slide.$content.length){slide.$content=slide.$slide.wrapInner('<div></div>').children().first()};slide.$content.addClass('fancybox-content');slide.$slide.addClass('fancybox-slide--'+slide.contentType);self.afterLoad(slide)},setError:function(slide){slide.hasError=true;slide.$slide.trigger('onReset').removeClass('fancybox-slide--'+slide.contentType).addClass('fancybox-slide--error');slide.contentType='html';this.setContent(slide,this.translate(slide,slide.opts.errorTpl));if(slide.pos===this.currPos){this.isAnimating=false}},showLoading:function(slide){var self=this;slide=slide||self.current;if(slide&&!slide.$spinner){slide.$spinner=$(self.translate(self,self.opts.spinnerTpl)).appendTo(slide.$slide).hide().fadeIn('fast')}},hideLoading:function(slide){var self=this;slide=slide||self.current;if(slide&&slide.$spinner){slide.$spinner.stop().remove();delete slide.$spinner}},afterLoad:function(slide){var self=this;if(self.isClosing){return};slide.isLoading=false;slide.isLoaded=true;self.trigger('afterLoad',slide);self.hideLoading(slide);if(slide.opts.smallBtn&&(!slide.$smallBtn||!slide.$smallBtn.length)){slide.$smallBtn=$(self.translate(slide,slide.opts.btnTpl.smallBtn)).appendTo(slide.$content)};if(slide.opts.protect&&slide.$content&&!slide.hasError){slide.$content.on('contextmenu.fb',function(e){if(e.button==2){e.preventDefault()};return true});if(slide.type==='image'){$('<div class="fancybox-spaceball"></div>').appendTo(slide.$content)}};self.adjustCaption(slide);self.adjustLayout(slide);if(slide.pos===self.currPos){self.updateCursor()};self.revealContent(slide)},adjustCaption:function(slide){var self=this,current=slide||self.current,caption=current.opts.caption,$caption=self.$refs.caption,captionH=false;if(current.opts.preventCaptionOverlap&&caption&&caption.length){if(current.pos!==self.currPos){$caption=$caption.clone().empty().appendTo($caption.parent());$caption.html(caption);captionH=$caption.outerHeight(true);$caption.empty().remove()}else if(self.$caption){captionH=self.$caption.outerHeight(true)};current.$slide.css('padding-bottom',captionH||'')}},adjustLayout:function(slide){var self=this,current=slide||self.current,scrollHeight,marginBottom,inlinePadding,actualPadding;if(current.isLoaded&&current.opts.disableLayoutFix!==true){current.$content.css('margin-bottom','');if(current.$content.outerHeight()>current.$slide.height()+0.5){inlinePadding=current.$slide[0].style['padding-bottom'];actualPadding=current.$slide.css('padding-bottom');if(parseFloat(actualPadding)>0){scrollHeight=current.$slide[0].scrollHeight;current.$slide.css('padding-bottom',0);if(Math.abs(scrollHeight-current.$slide[0].scrollHeight)<1){marginBottom=actualPadding};current.$slide.css('padding-bottom',inlinePadding)}};current.$content.css('margin-bottom',marginBottom)}},revealContent:function(slide){var self=this,$slide=slide.$slide,end=false,start=false,isMoved=self.isMoved(slide),isRevealed=slide.isRevealed,effect,effectClassName,duration,opacity;slide.isRevealed=true;effect=slide.opts[self.firstRun?'animationEffect':'transitionEffect'];duration=slide.opts[self.firstRun?'animationDuration':'transitionDuration'];duration=parseInt(slide.forcedDuration===undefined?duration:slide.forcedDuration,10);if(isMoved||slide.pos!==self.currPos||!duration){effect=false};if(effect==='zoom'){if(slide.pos===self.currPos&&duration&&slide.type==='image'&&!slide.hasError&&(start=self.getThumbPos(slide))){end=self.getFitPos(slide)}else{effect='fade'}};if(effect==='zoom'){self.isAnimating=true;end.scaleX=end.width/start.width;end.scaleY=end.height/start.height;opacity=slide.opts.zoomOpacity;if(opacity=='auto'){opacity=Math.abs(slide.width/slide.height-start.width/start.height)>0.1};if(opacity){start.opacity=0.1;end.opacity=1};$.fancybox.setTranslate(slide.$content.removeClass('fancybox-is-hidden'),start);forceRedraw(slide.$content);$.fancybox.animate(slide.$content,end,duration,function(){self.isAnimating=false;self.complete()});return};self.updateSlide(slide);if(!effect){slide.$content.removeClass('fancybox-is-hidden');if(!isRevealed&&isMoved&&slide.type==='image'&&!slide.hasError){slide.$content.hide().fadeIn('fast')};if(slide.pos===self.currPos){self.complete()};return};$.fancybox.stop($slide);effectClassName='fancybox-slide--'+(slide.pos>=self.prevPos?'next':'previous')+' fancybox-animated fancybox-fx-'+effect;$slide.addClass(effectClassName).removeClass('fancybox-slide--current');slide.$content.removeClass('fancybox-is-hidden');forceRedraw($slide);if(slide.type!=='image'){slide.$content.hide().show(0)};$.fancybox.animate($slide,'fancybox-slide--current',duration,function(){$slide.removeClass(effectClassName).css({transform:'',opacity:''});if(slide.pos===self.currPos){self.complete()}},true)},getThumbPos:function(slide){var rez=false,$thumb=slide.$thumb,thumbPos,btw,brw,bbw,blw;if(!$thumb||!inViewport($thumb[0])){return false};thumbPos=$.fancybox.getTranslate($thumb);btw=parseFloat($thumb.css('border-top-width')||0);brw=parseFloat($thumb.css('border-right-width')||0);bbw=parseFloat($thumb.css('border-bottom-width')||0);blw=parseFloat($thumb.css('border-left-width')||0);rez={top:thumbPos.top+btw,left:thumbPos.left+blw,width:thumbPos.width-brw-blw,height:thumbPos.height-btw-bbw,scaleX:1,scaleY:1};return thumbPos.width>0&&thumbPos.height>0?rez:false},complete:function(){var self=this,current=self.current,slides={},$el;if(self.isMoved()||!current.isLoaded){return};if(!current.isComplete){current.isComplete=true;current.$slide.siblings().trigger('onReset');self.preload('inline');forceRedraw(current.$slide);current.$slide.addClass('fancybox-slide--complete');$.each(self.slides,function(key,slide){if(slide.pos>=self.currPos-1&&slide.pos<=self.currPos+1){slides[slide.pos]=slide}else if(slide){$.fancybox.stop(slide.$slide);slide.$slide.off().remove()}});self.slides=slides};self.isAnimating=false;self.updateCursor();self.trigger('afterShow');if(!!current.opts.video.autoStart){current.$slide.find('video,audio').filter(':visible:first').trigger('play').one('ended',function(){if(this.webkitExitFullscreen){this.webkitExitFullscreen()};self.next()})};if(current.opts.autoFocus&&current.contentType==='html'){$el=current.$content.find('input[autofocus]:enabled:visible:first');if($el.length){$el.trigger('focus')}else{self.focus(null,true)}};current.$slide.scrollTop(0).scrollLeft(0)},preload:function(type){var self=this,prev,next;if(self.group.length<2){return};next=self.slides[self.currPos+1];prev=self.slides[self.currPos-1];if(prev&&prev.type===type){self.loadSlide(prev)};if(next&&next.type===type){self.loadSlide(next)}},focus:function(e,firstRun){var self=this,focusableStr=['a[href]','area[href]','input:not([disabled]):not([type="hidden"]):not([aria-hidden])','select:not([disabled]):not([aria-hidden])','textarea:not([disabled]):not([aria-hidden])','button:not([disabled]):not([aria-hidden])','iframe','object','embed','[contenteditable]','[tabindex]:not([tabindex^="-"])'].join(','),focusableItems,focusedItemIndex;if(self.isClosing){return};if(e||!self.current||!self.current.isComplete){focusableItems=self.$refs.container.find('*:visible')}else{focusableItems=self.current.$slide.find('*:visible'+(firstRun?':not(.fancybox-close-small)':''))};focusableItems=focusableItems.filter(focusableStr).filter(function(){return $(this).css('visibility')!=='hidden'&&!$(this).hasClass('disabled')});if(focusableItems.length){focusedItemIndex=focusableItems.index(document.activeElement);if(e&&e.shiftKey){if(focusedItemIndex<0||focusedItemIndex==0){e.preventDefault();focusableItems.eq(focusableItems.length-1).trigger('focus')}}else{if(focusedItemIndex<0||focusedItemIndex==focusableItems.length-1){if(e){e.preventDefault()};focusableItems.eq(0).trigger('focus')}}}else{self.$refs.container.trigger('focus')}},activate:function(){var self=this;$('.fancybox-container').each(function(){var instance=$(this).data('FancyBox');if(instance&&instance.id!==self.id&&!instance.isClosing){instance.trigger('onDeactivate');instance.removeEvents();instance.isVisible=false}});self.isVisible=true;if(self.current||self.isIdle){self.update();self.updateControls()};self.trigger('onActivate');self.addEvents()},close:function(e,d){var self=this,current=self.current,effect,duration,$content,domRect,opacity,start,end,done=function(){self.cleanUp(e)};if(self.isClosing){return false};self.isClosing=true;if(self.trigger('beforeClose',e)===false){self.isClosing=false;requestAFrame(function(){self.update()});return false};self.removeEvents();$content=current.$content;effect=current.opts.animationEffect;duration=$.isNumeric(d)?d:effect?current.opts.animationDuration:0;current.$slide.removeClass('fancybox-slide--complete fancybox-slide--next fancybox-slide--previous fancybox-animated');if(e!==true){$.fancybox.stop(current.$slide)}else{effect=false};current.$slide.siblings().trigger('onReset').remove();if(duration){self.$refs.container.removeClass('fancybox-is-open').addClass('fancybox-is-closing').css('transition-duration',duration+'ms')};self.hideLoading(current);self.hideControls(true);self.updateCursor();if(effect==='zoom'&&!($content&&duration&&current.type==='image'&&!self.isMoved()&&!current.hasError&&(end=self.getThumbPos(current)))){effect='fade'};if(effect==='zoom'){$.fancybox.stop($content);domRect=$.fancybox.getTranslate($content);start={top:domRect.top,left:domRect.left,scaleX:domRect.width/end.width,scaleY:domRect.height/end.height,width:end.width,height:end.height};opacity=current.opts.zoomOpacity;if(opacity=='auto'){opacity=Math.abs(current.width/current.height-end.width/end.height)>0.1};if(opacity){end.opacity=0};$.fancybox.setTranslate($content,start);forceRedraw($content);$.fancybox.animate($content,end,duration,done);return true};if(effect&&duration){$.fancybox.animate(current.$slide.addClass('fancybox-slide--previous').removeClass('fancybox-slide--current'),'fancybox-animated fancybox-fx-'+effect,duration,done)}else{if(e===true){setTimeout(done,duration)}else{done()}};return true},cleanUp:function(e){var self=this,instance,$focus=self.current.opts.$orig,x,y;self.current.$slide.trigger('onReset');self.$refs.container.empty().remove();self.trigger('afterClose',e);if(!!self.current.opts.backFocus){if(!$focus||!$focus.length||!$focus.is(':visible')){$focus=self.$trigger};if($focus&&$focus.length){x=window.scrollX;y=window.scrollY;$focus.trigger('focus');$('html, body').scrollTop(y).scrollLeft(x)}};self.current=null;instance=$.fancybox.getInstance();if(instance){instance.activate()}else{$('body').removeClass('fancybox-active compensate-for-scrollbar');$('#fancybox-style-noscroll').remove()}},trigger:function(name,slide){var args=Array.prototype.slice.call(arguments,1),self=this,obj=slide&&slide.opts?slide:self.current,rez;if(obj){args.unshift(obj)}else{obj=self};args.unshift(self);if($.isFunction(obj.opts[name])){rez=obj.opts[name].apply(obj,args)};if(rez===false){return rez};if(name==='afterClose'||!self.$refs){$D.trigger(name+'.fb',args)}else{self.$refs.container.trigger(name+'.fb',args)}},updateControls:function(){var self=this,current=self.current,index=current.index,$container=self.$refs.container,$caption=self.$refs.caption,caption=current.opts.caption;current.$slide.trigger('refresh');self.$caption=caption&&caption.length?$caption.html(caption):null;if(!self.hasHiddenControls&&!self.isIdle){self.showControls()};$container.find('[data-fancybox-count]').html(self.group.length);$container.find('[data-fancybox-index]').html(index+1);$container.find('[data-fancybox-prev]').prop('disabled',!current.opts.loop&&index<=0);$container.find('[data-fancybox-next]').prop('disabled',!current.opts.loop&&index>=self.group.length-1);if(current.type==='image'){$container.find('[data-fancybox-zoom]').show().end().find('[data-fancybox-download]').attr('href',current.opts.image.src||current.src).show()}else if(current.opts.toolbar){$container.find('[data-fancybox-download],[data-fancybox-zoom]').hide()};if($(document.activeElement).is(':hidden,[disabled]')){self.$refs.container.trigger('focus')}},hideControls:function(andCaption){var self=this,arr=['infobar','toolbar','nav'];if(andCaption||!self.current.opts.preventCaptionOverlap){arr.push('caption')};this.$refs.container.removeClass(arr.map(function(i){return'fancybox-show-'+i}).join(' '));this.hasHiddenControls=true},showControls:function(){var self=this,opts=self.current?self.current.opts:self.opts,$container=self.$refs.container;self.hasHiddenControls=false;self.idleSecondsCounter=0;$container.toggleClass('fancybox-show-toolbar',!!(opts.toolbar&&opts.buttons)).toggleClass('fancybox-show-infobar',!!(opts.infobar&&self.group.length>1)).toggleClass('fancybox-show-caption',!!self.$caption).toggleClass('fancybox-show-nav',!!(opts.arrows&&self.group.length>1)).toggleClass('fancybox-is-modal',!!opts.modal)},toggleControls:function(){if(this.hasHiddenControls){this.showControls()}else{this.hideControls()}}});$.fancybox={version:'{fancybox-version}',defaults:defaults,getInstance:function(command){var instance=$('.fancybox-container:not(".fancybox-is-closing"):last').data('FancyBox'),args=Array.prototype.slice.call(arguments,1);if(instance instanceof FancyBox){if($.type(command)==='string'){instance[command].apply(instance,args)}else if($.type(command)==='function'){command.apply(instance,args)};return instance};return false},open:function(items,opts,index){return new FancyBox(items,opts,index)},close:function(all){var instance=this.getInstance();if(instance){instance.close();if(all===true){this.close(all)}}},destroy:function(){this.close(true);$D.add('body').off('click.fb-start','**')},isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),use3d:(function(){var div=document.createElement('div');return(window.getComputedStyle&&window.getComputedStyle(div)&&window.getComputedStyle(div).getPropertyValue('transform')&&!(document.documentMode&&document.documentMode<11))})(),getTranslate:function($el){var domRect;if(!$el||!$el.length){return false};domRect=$el[0].getBoundingClientRect();return{top:domRect.top||0,left:domRect.left||0,width:domRect.width,height:domRect.height,opacity:parseFloat($el.css('opacity'))}},setTranslate:function($el,props){var str='',css={};if(!$el||!props){return};if(props.left!==undefined||props.top!==undefined){str=(props.left===undefined?$el.position().left:props.left)+'px, '+(props.top===undefined?$el.position().top:props.top)+'px';if(this.use3d){str='translate3d('+str+', 0px)'}else{str='translate('+str+')'}};if(props.scaleX!==undefined&&props.scaleY!==undefined){str+=' scale('+props.scaleX+', '+props.scaleY+')'}else if(props.scaleX!==undefined){str+=' scaleX('+props.scaleX+')'};if(str.length){css.transform=str};if(props.opacity!==undefined){css.opacity=props.opacity};if(props.width!==undefined){css.width=props.width};if(props.height!==undefined){css.height=props.height};return $el.css(css)},animate:function($el,to,duration,callback,leaveAnimationName){var self=this,from;if($.isFunction(duration)){callback=duration;duration=null};self.stop($el);from=self.getTranslate($el);$el.on(transitionEnd,function(e){if(e&&e.originalEvent&&(!$el.is(e.originalEvent.target)||e.originalEvent.propertyName=='z-index')){return};self.stop($el);if($.isNumeric(duration)){$el.css('transition-duration','')};if($.isPlainObject(to)){if(to.scaleX!==undefined&&to.scaleY!==undefined){self.setTranslate($el,{top:to.top,left:to.left,width:from.width*to.scaleX,height:from.height*to.scaleY,scaleX:1,scaleY:1})}}else if(leaveAnimationName!==true){$el.removeClass(to)};if($.isFunction(callback)){callback(e)}});if($.isNumeric(duration)){$el.css('transition-duration',duration+'ms')};if($.isPlainObject(to)){if(to.scaleX!==undefined&&to.scaleY!==undefined){delete to.width;delete to.height;if($el.parent().hasClass('fancybox-slide--image')){$el.parent().addClass('fancybox-is-scaling')}};$.fancybox.setTranslate($el,to)}else{$el.addClass(to)};$el.data('timer',setTimeout(function(){$el.trigger(transitionEnd)},duration+33))},stop:function($el,callCallback){if($el&&$el.length){clearTimeout($el.data('timer'));if(callCallback){$el.trigger(transitionEnd)};$el.off(transitionEnd).css('transition-duration','');$el.parent().removeClass('fancybox-is-scaling')}}};function _run(e,opts){var items=[],index=0,$target,value,instance;if(e&&e.isDefaultPrevented()){return};e.preventDefault();opts=opts||{};if(e&&e.data){opts=mergeOpts(e.data.options,opts)};$target=opts.$target||$(e.currentTarget).trigger('blur');instance=$.fancybox.getInstance();if(instance&&instance.$trigger&&instance.$trigger.is($target)){return};if(opts.selector){items=$(opts.selector)}else{value=$target.attr('data-fancybox')||'';if(value){items=e.data?e.data.items:[];items=items.length?items.filter('[data-fancybox="'+value+'"]'):$('[data-fancybox="'+value+'"]')}else{items=[$target]}};index=$(items).index($target);if(index<0){index=0};instance=$.fancybox.open(items,opts,index);instance.$trigger=$target};$.fn.fancybox=function(options){var selector;options=options||{};selector=options.selector||false;if(selector){$('body').off('click.fb-start',selector).on('click.fb-start',selector,{options:options},_run)}else{this.off('click.fb-start').on('click.fb-start',{items:this,options:options},_run)};return this};$D.on('click.fb-start','[data-fancybox]',_run);$D.on('click.fb-start','[data-fancybox-trigger]',function(e){$('[data-fancybox="'+$(this).attr('data-fancybox-trigger')+'"]').eq($(this).attr('data-fancybox-index')||0).trigger('click.fb-start',{$trigger:$(this)})});(function(){var buttonStr='.fancybox-button',focusStr='fancybox-focus',$pressed=null;$D.on('mousedown mouseup focus blur',buttonStr,function(e){switch(e.type){case'mousedown':$pressed=$(this);break;case'mouseup':$pressed=null;break;case'focusin':$(buttonStr).removeClass(focusStr);if(!$(this).is($pressed)&&!$(this).is('[disabled]')){$(this).addClass(focusStr)};break;case'focusout':$(buttonStr).removeClass(focusStr);break}})})()})(window,document,jQuery);typeof JSON!='object'&&(JSON={}),function(){'use strict';function f(e){return e<10?'0'+e:e};function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=='string'?t:'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'};function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=='object'&&typeof a.toJSON=='function'&&(a=a.toJSON(e)),typeof rep=='function'&&(a=rep.call(t,e,a));switch(typeof a){case'string':return quote(a);case'number':return isFinite(a)?String(a):'null';case'boolean':case'null':return String(a);case'object':if(!a)return'null';gap+=indent,u=[];if(Object.prototype.toString.apply(a)==='[object Array]'){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||'null';return i=u.length===0?'[]':gap?'[\n'+gap+u.join(',\n'+gap)+'\n'+o+']':'['+u.join(',')+']',gap=o,i};if(rep&&typeof rep=='object'){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=='string'&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?': ':':')+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?': ':':')+i));return i=u.length===0?'{}':gap?'{\n'+gap+u.join(',\n'+gap)+'\n'+o+'}':'{'+u.join(',')+'}',gap=o,i}};typeof Date.prototype.toJSON!='function'&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','	':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;typeof JSON.stringify!='function'&&(JSON.stringify=function(e,t,n){var r;gap='',indent='';if(typeof n=='number')for(r=0;r<n;r+=1)indent+=' ';else typeof n=='string'&&(indent=n);rep=t;if(!t||typeof t=='function'||typeof t=='object'&&typeof t.length=='number')return str('',{'':e});throw new Error('JSON.stringify');}),typeof JSON.parse!='function'&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=='object')for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)};var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return'\\u'+('0000'+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'')))return j=eval('('+text+')'),typeof reviver=='function'?walk({'':j},''):j;throw new SyntaxError('JSON.parse');})}(),function(e,t){'use strict';var n=e.History=e.History||{},r=e.jQuery;if(typeof n.Adapter!='undefined')throw new Error('History.js Adapter has already been loaded...');n.Adapter={bind:function(e,t,n){r(e).bind(t,n)},trigger:function(e,t,n){r(e).trigger(t,n)},extractEventData:function(e,n,r){var i=n&&n.originalEvent&&n.originalEvent[e]||r&&r[e]||t;return i},onDomLoad:function(e){r(e)}},typeof n.init!='undefined'&&n.init()}(window),function(e,t){'use strict';var n=e.document,r=e.setTimeout||r,i=e.clearTimeout||i,s=e.setInterval||s,o=e.History=e.History||{};if(typeof o.initHtml4!='undefined')throw new Error('History.js HTML4 Support has already been loaded...');o.initHtml4=function(){if(typeof o.initHtml4.initialized!='undefined')return!1;o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t=o.getHashByIndex(),n;return n=e===t,n},o.isHashEqual=function(e,t){return e=encodeURIComponent(e).replace(/%25/g,'%'),t=encodeURIComponent(t).replace(/%25/g,'%'),e===t},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return typeof e=='undefined'?t=o.savedHashes[o.savedHashes.length-1]:e<0?t=o.savedHashes[o.savedHashes.length+e]:t=o.savedHashes[e],t},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,n){var r=o.getHashByState(e),i;return i={discardedState:e,backState:n,forwardState:t},o.discardedStates[r]=i,!0},o.discardHash=function(e,t,n){var r={discardedHash:e,backState:n,forwardState:t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t=o.getHashByState(e),n;return n=o.discardedStates[t]||!1,n},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var t='',r,i,u,a,f=Boolean(o.getHash());return o.isInternetExplorer()?(r='historyjs-iframe',i=n.createElement('iframe'),i.setAttribute('id',r),i.setAttribute('src','#'),i.style.display='none',n.body.appendChild(i),i.contentWindow.document.open(),i.contentWindow.document.close(),u='',a=!1,o.checkerFunction=function(){if(a)return!1;a=!0;var n=o.getHash(),r=o.getHash(i.contentWindow.document);return n!==t?(t=n,r!==n&&(u=r=n,i.contentWindow.document.open(),i.contentWindow.document.close(),i.contentWindow.document.location.hash=o.escapeHash(n)),o.Adapter.trigger(e,'hashchange')):r!==u&&(u=r,f&&r===''?o.back():o.setHash(r,!1)),a=!1,!0}):o.checkerFunction=function(){var n=o.getHash()||'';return n!==t&&(t=n,o.Adapter.trigger(e,'hashchange')),!0},o.intervalList.push(s(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(t){var n=t&&t.newURL||o.getLocationHref(),r=o.getHashByUrl(n),i=null,s=null,u=null,a;return o.isLastHash(r)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(r),r&&o.isTraditionalAnchor(r)?(o.Adapter.trigger(e,'anchorchange'),o.busy(!1),!1):(i=o.extractState(o.getFullUrl(r||o.getLocationHref()),!0),o.isLastSavedState(i)?(o.busy(!1),!1):(s=o.getHashByState(i),a=o.discardedState(i),a?(o.getHashByIndex(-2)===o.getHashByState(a.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(i.data,i.title,encodeURI(i.url),!1),!0))))},o.Adapter.bind(e,'hashchange',o.onHashChange),o.pushState=function(t,n,r,i){r=encodeURI(r).replace(/%25/g,'%');if(o.getHashByUrl(r))throw new Error('History.js does not support states with fragment-identifiers (hashes/anchors).');if(i!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.pushState,args:arguments,queue:i}),!1;o.busy(!0);var s=o.createStateObject(t,n,r),u=o.getHashByState(s),a=o.getState(!1),f=o.getHashByState(a),l=o.getHash(),c=o.expectedStateId==s.id;return o.storeState(s),o.expectedStateId=s.id,o.recycleState(s),o.setTitle(s),u===f?(o.busy(!1),!1):(o.saveState(s),c||o.Adapter.trigger(e,'statechange'),!o.isHashEqual(u,l)&&!o.isHashEqual(u,o.getShortUrl(o.getLocationHref()))&&o.setHash(u,!1),o.busy(!1),!0)},o.replaceState=function(t,n,r,i){r=encodeURI(r).replace(/%25/g,'%');if(o.getHashByUrl(r))throw new Error('History.js does not support states with fragment-identifiers (hashes/anchors).');if(i!==!1&&o.busy())return o.pushQueue({scope:o,callback:o.replaceState,args:arguments,queue:i}),!1;o.busy(!0);var s=o.createStateObject(t,n,r),u=o.getHashByState(s),a=o.getState(!1),f=o.getHashByState(a),l=o.getStateByIndex(-2);return o.discardState(a,s,l),u===f?(o.storeState(s),o.expectedStateId=s.id,o.recycleState(s),o.setTitle(s),o.saveState(s),o.Adapter.trigger(e,'statechange'),o.busy(!1)):o.pushState(s.data,s.title,s.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,'hashchange')})},typeof o.init!='undefined'&&o.init()}(window),function(e,t){'use strict';var n=e.console||t,r=e.document,i=e.navigator,s=!1,o=e.setTimeout,u=e.clearTimeout,a=e.setInterval,f=e.clearInterval,l=e.JSON,c=e.alert,h=e.History=e.History||{},p=e.history;try{s=e.sessionStorage,s.setItem('TEST','1'),s.removeItem('TEST')}catch(catch$scope$var1347216585){s=!1};l.stringify=l.stringify||l.encode,l.parse=l.parse||l.decode;if(typeof h.init!='undefined')throw new Error('History.js Core has already been loaded...');h.init=function(e){return typeof h.Adapter=='undefined'?!1:(typeof h.initCore!='undefined'&&h.initCore(),typeof h.initHtml4!='undefined'&&h.initHtml4(),!0)},h.initCore=function(d){if(typeof h.initCore.initialized!='undefined')return!1;h.initCore.initialized=!0,h.options=h.options||{},h.options.hashChangeInterval=h.options.hashChangeInterval||100,h.options.safariPollInterval=h.options.safariPollInterval||500,h.options.doubleCheckInterval=h.options.doubleCheckInterval||500,h.options.disableSuid=h.options.disableSuid||!1,h.options.storeInterval=h.options.storeInterval||1e3,h.options.busyDelay=h.options.busyDelay||250,h.options.debug=h.options.debug||!1,h.options.initialTitle=h.options.initialTitle||r.title,h.options.html4Mode=h.options.html4Mode||!1,h.options.delayInit=h.options.delayInit||!1,h.intervalList=[],h.clearAllIntervals=function(){var e,t=h.intervalList;if(typeof t!='undefined'&&t!==null){for(e=0;e<t.length;e++)f(t[e]);h.intervalList=null}},h.debug=function(){(h.options.debug||!1)&&h.log.apply(h,arguments)},h.log=function(){var e=typeof n!='undefined'&&typeof n.log!='undefined'&&typeof n.log.apply!='undefined',t=r.getElementById('log'),i,s,o,u,a;e?(u=Array.prototype.slice.call(arguments),i=u.shift(),typeof n.debug!='undefined'?n.debug.apply(n,[i,u]):n.log.apply(n,[i,u])):i='\n'+arguments[0]+'\n';for(s=1,o=arguments.length;s<o;++s){a=arguments[s];if(typeof a=='object'&&typeof l!='undefined')try{a=l.stringify(a)}catch(catch$scope$var1347216585){};i+='\n'+a+'\n'};return t?(t.value+=i+'\n-----\n',t.scrollTop=t.scrollHeight-t.clientHeight):e||c(i),!0},h.getInternetExplorerMajorVersion=function(){var e=h.getInternetExplorerMajorVersion.cached=typeof h.getInternetExplorerMajorVersion.cached!='undefined'?h.getInternetExplorerMajorVersion.cached:function(){var e=3,t=r.createElement('div'),n=t.getElementsByTagName('i');while((t.innerHTML='<!--[if gt IE '+(++e)+']><i></i><![endif]-->')&&n[0]);return e>4?e:!1}();return e},h.isInternetExplorer=function(){var e=h.isInternetExplorer.cached=typeof h.isInternetExplorer.cached!='undefined'?h.isInternetExplorer.cached:Boolean(h.getInternetExplorerMajorVersion());return e},h.options.html4Mode?h.emulated={pushState:!0,hashChange:!0}:h.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent)),hashChange:Boolean(!('onhashchange'in e||'onhashchange'in r)||h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8)},h.enabled=!h.emulated.pushState,h.bugs={setHash:Boolean(!h.emulated.pushState&&i.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),safariPoll:Boolean(!h.emulated.pushState&&i.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),ieDoubleCheck:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(h.isInternetExplorer()&&h.getInternetExplorerMajorVersion()<7)},h.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},h.cloneObject=function(e){var t,n;return e?(t=l.stringify(e),n=l.parse(t)):n={},n},h.getRootUrl=function(){var e=r.location.protocol+'//'+(r.location.hostname||r.location.host);if(r.location.port||!1)e+=':'+r.location.port;return e+='/',e},h.getBaseHref=function(){var e=r.getElementsByTagName('base'),t=null,n='';return e.length===1&&(t=e[0],n=t.href.replace(/[^\/]+$/,'')),n=n.replace(/\/+$/,''),n&&(n+='/'),n},h.getBaseUrl=function(){var e=h.getBaseHref()||h.getBasePageUrl()||h.getRootUrl();return e},h.getPageUrl=function(){var e=h.getState(!1,!1),t=(e||{}).url||h.getLocationHref(),n;return n=t.replace(/\/+$/,'').replace(/[^\/]+$/,function(e,t,n){return/\./.test(e)?e:e+'/'}),n},h.getBasePageUrl=function(){var e=h.getLocationHref().replace(/[#\?].*/,'').replace(/[^\/]+$/,function(e,t,n){return/[^\/]$/.test(e)?'':e}).replace(/\/+$/,'')+'/';return e},h.getFullUrl=function(e,t){var n=e,r=e.substring(0,1);return t=typeof t=='undefined'?!0:t,/[a-z]+\:\/\//.test(e)||(r==='/'?n=h.getRootUrl()+e.replace(/^\/+/,''):r==='#'?n=h.getPageUrl().replace(/#.*/,'')+e:r==='?'?n=h.getPageUrl().replace(/[\?#].*/,'')+e:t?n=h.getBaseUrl()+e.replace(/^(\.\/)+/,''):n=h.getBasePageUrl()+e.replace(/^(\.\/)+/,'')),n.replace(/\#$/,'')},h.getShortUrl=function(e){var t=e,n=h.getBaseUrl(),r=h.getRootUrl();return h.emulated.pushState&&(t=t.replace(n,'')),t=t.replace(r,'/'),h.isTraditionalAnchor(t)&&(t='./'+t),t=t.replace(/^(\.\/)+/g,'./').replace(/\#$/,''),t},h.getLocationHref=function(e){return e=e||r,e.URL===e.location.href?e.location.href:e.location.href===decodeURIComponent(e.URL)?e.URL:e.location.hash&&decodeURIComponent(e.location.href.replace(/^[^#]+/,''))===e.location.hash?e.location.href:e.URL.indexOf('#')==-1&&e.location.href.indexOf('#')!=-1?e.location.href:e.URL||e.location.href},h.store={},h.idToState=h.idToState||{},h.stateToId=h.stateToId||{},h.urlToId=h.urlToId||{},h.storedStates=h.storedStates||[],h.savedStates=h.savedStates||[],h.normalizeStore=function(){h.store.idToState=h.store.idToState||{},h.store.urlToId=h.store.urlToId||{},h.store.stateToId=h.store.stateToId||{}},h.getState=function(e,t){typeof e=='undefined'&&(e=!0),typeof t=='undefined'&&(t=!0);var n=h.getLastSavedState();return!n&&t&&(n=h.createStateObject()),e&&(n=h.cloneObject(n),n.url=n.cleanUrl||n.url),n},h.getIdByState=function(e){var t=h.extractId(e.url),n;if(!t){n=h.getStateString(e);if(typeof h.stateToId[n]!='undefined')t=h.stateToId[n];else if(typeof h.store.stateToId[n]!='undefined')t=h.store.stateToId[n];else{for(;;){t=(new Date).getTime()+String(Math.random()).replace(/\D/g,'');if(typeof h.idToState[t]=='undefined'&&typeof h.store.idToState[t]=='undefined')break};h.stateToId[n]=t,h.idToState[t]=e}};return t},h.normalizeState=function(e){var t,n;if(!e||typeof e!='object')e={};if(typeof e.normalized!='undefined')return e;if(!e.data||typeof e.data!='object')e.data={};return t={},t.normalized=!0,t.title=e.title||'',t.url=h.getFullUrl(e.url?e.url:h.getLocationHref()),t.hash=h.getShortUrl(t.url),t.data=h.cloneObject(e.data),t.id=h.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,''),t.url=t.cleanUrl,n=!h.isEmptyObject(t.data),(t.title||n)&&h.options.disableSuid!==!0&&(t.hash=h.getShortUrl(t.url).replace(/\??\&_suid.*/,''),/\?/.test(t.hash)||(t.hash+='?'),t.hash+='&_suid='+t.id),t.hashedUrl=h.getFullUrl(t.hash),(h.emulated.pushState||h.bugs.safariPoll)&&h.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t},h.createStateObject=function(e,t,n){var r={data:e,title:t,url:n};return r=h.normalizeState(r),r},h.getStateById=function(e){e=String(e);var n=h.idToState[e]||h.store.idToState[e]||t;return n},h.getStateString=function(e){var t,n,r;return t=h.normalizeState(e),n={data:t.data,title:e.title,url:e.url},r=l.stringify(n),r},h.getStateId=function(e){var t,n;return t=h.normalizeState(e),n=t.id,n},h.getHashByState=function(e){var t,n;return t=h.normalizeState(e),n=t.hash,n},h.extractId=function(e){var t,n,r,i;return e.indexOf('#')!=-1?i=e.split('#')[0]:i=e,n=/(.*)\&_suid=([0-9]+)$/.exec(i),r=n?n[1]||e:e,t=n?String(n[2]||''):'',t||!1},h.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},h.extractState=function(e,t){var n=null,r,i;return t=t||!1,r=h.extractId(e),r&&(n=h.getStateById(r)),n||(i=h.getFullUrl(e),r=h.getIdByUrl(i)||!1,r&&(n=h.getStateById(r)),!n&&t&&!h.isTraditionalAnchor(e)&&(n=h.createStateObject(null,null,i))),n},h.getIdByUrl=function(e){var n=h.urlToId[e]||h.store.urlToId[e]||t;return n},h.getLastSavedState=function(){return h.savedStates[h.savedStates.length-1]||t},h.getLastStoredState=function(){return h.storedStates[h.storedStates.length-1]||t},h.hasUrlDuplicate=function(e){var t=!1,n;return n=h.extractState(e.url),t=n&&n.id!==e.id,t},h.storeState=function(e){return h.urlToId[e.url]=e.id,h.storedStates.push(h.cloneObject(e)),e},h.isLastSavedState=function(e){var t=!1,n,r,i;return h.savedStates.length&&(n=e.id,r=h.getLastSavedState(),i=r.id,t=n===i),t},h.saveState=function(e){return h.isLastSavedState(e)?!1:(h.savedStates.push(h.cloneObject(e)),!0)},h.getStateByIndex=function(e){var t=null;return typeof e=='undefined'?t=h.savedStates[h.savedStates.length-1]:e<0?t=h.savedStates[h.savedStates.length+e]:t=h.savedStates[e],t},h.getCurrentIndex=function(){var e=null;return h.savedStates.length<1?e=0:e=h.savedStates.length-1,e},h.getHash=function(e){var t=h.getLocationHref(e),n;return n=h.getHashByUrl(t),n},h.unescapeHash=function(e){var t=h.normalizeHash(e);return t=decodeURIComponent(t),t},h.normalizeHash=function(e){var t=e.replace(/[^#]*#/,'').replace(/#.*/,'');return t},h.setHash=function(e,t){var n,i;return t!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.setHash,args:arguments,queue:t}),!1):(h.busy(!0),n=h.extractState(e,!0),n&&!h.emulated.pushState?h.pushState(n.data,n.title,n.url,!1):h.getHash()!==e&&(h.bugs.setHash?(i=h.getPageUrl(),h.pushState(null,null,i+'#'+e,!1)):r.location.hash=e),h)},h.escapeHash=function(t){var n=h.normalizeHash(t);return n=e.encodeURIComponent(n),h.bugs.hashEscape||(n=n.replace(/\%21/g,'!').replace(/\%26/g,'&').replace(/\%3D/g,'=').replace(/\%3F/g,'?')),n},h.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,'$2');return t=h.unescapeHash(t),t},h.setTitle=function(e){var t=e.title,n;t||(n=h.getStateByIndex(0),n&&n.url===e.url&&(t=n.title||h.options.initialTitle));try{r.getElementsByTagName('title')[0].innerHTML=t.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ')}catch(catch$scope$var1347216585){};return r.title=t,h},h.queues=[],h.busy=function(e){typeof e!='undefined'?h.busy.flag=e:typeof h.busy.flag=='undefined'&&(h.busy.flag=!1);if(!h.busy.flag){u(h.busy.timeout);var t=function(){var e,n,r;if(h.busy.flag)return;for(e=h.queues.length-1;e>=0;--e){n=h.queues[e];if(n.length===0)continue;r=n.shift(),h.fireQueueItem(r),h.busy.timeout=o(t,h.options.busyDelay)}};h.busy.timeout=o(t,h.options.busyDelay)};return h.busy.flag},h.busy.flag=!1,h.fireQueueItem=function(e){return e.callback.apply(e.scope||h,e.args||[])},h.pushQueue=function(e){return h.queues[e.queue||0]=h.queues[e.queue||0]||[],h.queues[e.queue||0].push(e),h},h.queue=function(e,t){return typeof e=='function'&&(e={callback:e}),typeof t!='undefined'&&(e.queue=t),h.busy()?h.pushQueue(e):h.fireQueueItem(e),h},h.clearQueue=function(){return h.busy.flag=!1,h.queues=[],h},h.stateChanged=!1,h.doubleChecker=!1,h.doubleCheckComplete=function(){return h.stateChanged=!0,h.doubleCheckClear(),h},h.doubleCheckClear=function(){return h.doubleChecker&&(u(h.doubleChecker),h.doubleChecker=!1),h},h.doubleCheck=function(e){return h.stateChanged=!1,h.doubleCheckClear(),h.bugs.ieDoubleCheck&&(h.doubleChecker=o(function(){return h.doubleCheckClear(),h.stateChanged||e(),!0},h.options.doubleCheckInterval)),h},h.safariStatePoll=function(){var t=h.extractState(h.getLocationHref()),n;if(!h.isLastSavedState(t))return n=t,n||(n=h.createStateObject()),h.Adapter.trigger(e,'popstate'),h;return},h.back=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.back,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.back(!1)}),p.go(-1),!0)},h.forward=function(e){return e!==!1&&h.busy()?(h.pushQueue({scope:h,callback:h.forward,args:arguments,queue:e}),!1):(h.busy(!0),h.doubleCheck(function(){h.forward(!1)}),p.go(1),!0)},h.go=function(e,t){var n;if(e>0)for(n=1;n<=e;++n)h.forward(t);else{if(!(e<0))throw new Error('History.go: History.go requires a positive or negative integer passed.');for(n=-1;n>=e;--n)h.back(t)};return h};if(h.emulated.pushState){var v=function(){};h.pushState=h.pushState||v,h.replaceState=h.replaceState||v}else h.onPopState=function(t,n){var r=!1,i=!1,s,o;return h.doubleCheckComplete(),s=h.getHash(),s?(o=h.extractState(s||h.getLocationHref(),!0),o?h.replaceState(o.data,o.title,o.url,!1):(h.Adapter.trigger(e,'anchorchange'),h.busy(!1)),h.expectedStateId=!1,!1):(r=h.Adapter.extractEventData('state',t,n)||!1,r?i=h.getStateById(r):h.expectedStateId?i=h.getStateById(h.expectedStateId):i=h.extractState(h.getLocationHref()),i||(i=h.createStateObject(null,null,h.getLocationHref())),h.expectedStateId=!1,h.isLastSavedState(i)?(h.busy(!1),!1):(h.storeState(i),h.saveState(i),h.setTitle(i),h.Adapter.trigger(e,'statechange'),h.busy(!1),!0))},h.Adapter.bind(e,'popstate',h.onPopState),h.pushState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.pushState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.pushState(s.id,s.title,s.url),h.Adapter.trigger(e,'popstate')),!0},h.replaceState=function(t,n,r,i){if(h.getHashByUrl(r)&&h.emulated.pushState)throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');if(i!==!1&&h.busy())return h.pushQueue({scope:h,callback:h.replaceState,args:arguments,queue:i}),!1;h.busy(!0);var s=h.createStateObject(t,n,r);return h.isLastSavedState(s)?h.busy(!1):(h.storeState(s),h.expectedStateId=s.id,p.replaceState(s.id,s.title,s.url),h.Adapter.trigger(e,'popstate')),!0};if(s){try{h.store=l.parse(s.getItem('History.store'))||{}}catch(catch$scope$var1347216585){h.store={}};h.normalizeStore()}else h.store={},h.normalizeStore();h.Adapter.bind(e,'unload',h.clearAllIntervals),h.saveState(h.storeState(h.extractState(h.getLocationHref(),!0))),s&&(h.onUnload=function(){var e,t,n;try{e=l.parse(s.getItem('History.store'))||{}}catch(catch$scope$var1347216585){e={}};e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in h.idToState){if(!h.idToState.hasOwnProperty(t))continue;e.idToState[t]=h.idToState[t]};for(t in h.urlToId){if(!h.urlToId.hasOwnProperty(t))continue;e.urlToId[t]=h.urlToId[t]};for(t in h.stateToId){if(!h.stateToId.hasOwnProperty(t))continue;e.stateToId[t]=h.stateToId[t]};h.store=e,h.normalizeStore(),n=l.stringify(e);try{s.setItem('History.store',n)}catch(catch$scope$var1347216585){if(catch$scope$var1347216585.code!==DOMException.QUOTA_EXCEEDED_ERR)throw catch$scope$var1347216585;s.length&&(s.removeItem('History.store'),s.setItem('History.store',n))}},h.intervalList.push(a(h.onUnload,h.options.storeInterval)),h.Adapter.bind(e,'beforeunload',h.onUnload),h.Adapter.bind(e,'unload',h.onUnload));if(!h.emulated.pushState){h.bugs.safariPoll&&h.intervalList.push(a(h.safariStatePoll,h.options.safariPollInterval));if(i.vendor==='Apple Computer, Inc.'||(i.appCodeName||'')==='Mozilla')h.Adapter.bind(e,'hashchange',function(){h.Adapter.trigger(e,'popstate')}),h.getHash()&&h.Adapter.onDomLoad(function(){h.Adapter.trigger(e,'hashchange')})}},(!h.options||!h.options.delayInit)&&h.init()}(window);(function(factory){if(typeof define==='function'&&define.amd){define(['inputmask.dependencyLib'],factory)}else if(typeof exports==='object'){module.exports=factory(require('./inputmask.dependencyLib.jquery'))}else{factory(window.dependencyLib||jQuery)}}(function($){function Inputmask(alias,options){if(!(this instanceof Inputmask)){return new Inputmask(alias,options)};if($.isPlainObject(alias)){options=alias}else{options=options||{};options.alias=alias};this.el=undefined;this.opts=$.extend(true,{},this.defaults,options);this.noMasksCache=options&&options.definitions!==undefined;this.userOptions=options||{};this.events={};resolveAlias(this.opts.alias,options,this.opts)};Inputmask.prototype={defaults:{placeholder:'_',optionalmarker:{start:'[',end:']'},quantifiermarker:{start:'{',end:'}'},groupmarker:{start:'(',end:')'},alternatormarker:'|',escapeChar:'\\',mask:null,oncomplete:$.noop,onincomplete:$.noop,oncleared:$.noop,repeat:0,greedy:true,autoUnmask:false,removeMaskOnSubmit:false,clearMaskOnLostFocus:true,insertMode:true,clearIncomplete:false,aliases:{},alias:null,onKeyDown:$.noop,onBeforeMask:null,onBeforePaste:function(pastedValue,opts){return $.isFunction(opts.onBeforeMask)?opts.onBeforeMask(pastedValue,opts):pastedValue},onBeforeWrite:null,onUnMask:null,showMaskOnFocus:true,showMaskOnHover:true,onKeyValidation:$.noop,skipOptionalPartCharacter:' ',showTooltip:false,tooltip:undefined,numericInput:false,rightAlign:false,undoOnEscape:true,radixPoint:'',radixPointDefinitionSymbol:undefined,groupSeparator:'',keepStatic:null,positionCaretOnTab:false,tabThrough:false,supportsInputType:['text','tel','password'],definitions:{'9':{validator:'[0-9]',cardinality:1,definitionSymbol:'*'},'a':{validator:'[A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]',cardinality:1,definitionSymbol:'*'},'*':{validator:'[0-9A-Za-z\u0410-\u044F\u0401\u0451\u00C0-\u00FF\u00B5]',cardinality:1}},ignorables:[8,9,13,19,27,33,34,35,36,37,38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],isComplete:null,canClearPosition:$.noop,postValidation:null,staticDefinitionSymbol:undefined,jitMasking:false,nullable:true,inputEventOnly:false,positionCaretOnClick:'lvp'},masksCache:{},mask:function(elems){var that=this;if(typeof elems==='string'){elems=document.getElementById(elems)||document.querySelectorAll(elems)};elems=elems.nodeName?[elems]:elems;$.each(elems,function(ndx,el){var scopedOpts=$.extend(true,{},that.opts);importAttributeOptions(el,scopedOpts,$.extend(true,{},that.userOptions));var maskset=generateMaskSet(scopedOpts,that.noMasksCache);if(maskset!==undefined){if(el.inputmask!==undefined){el.inputmask.remove()};el.inputmask=new Inputmask();el.inputmask.opts=scopedOpts;el.inputmask.noMasksCache=that.noMasksCache;el.inputmask.userOptions=$.extend(true,{},that.userOptions);el.inputmask.el=el;el.inputmask.maskset=maskset;el.inputmask.isRTL=false;$.data(el,'_inputmask_opts',scopedOpts);maskScope({'action':'mask','el':el})}});return elems&&elems[0]?(elems[0].inputmask||this):this},option:function(options,noremask){if(typeof options==='string'){return this.opts[options]}else if(typeof options==='object'){$.extend(this.userOptions,options);if(this.el&&noremask!==true){this.mask(this.el)};return this}},unmaskedvalue:function(value){return maskScope({'action':'unmaskedvalue','el':this.el,'value':value},this.el&&this.el.inputmask?this.el.inputmask.maskset:generateMaskSet(this.opts,this.noMasksCache),this.opts)},remove:function(){if(this.el){maskScope({'action':'remove','el':this.el});this.el.inputmask=undefined;return this.el}},getemptymask:function(){return maskScope({'action':'getemptymask'},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},hasMaskedValue:function(){return!this.opts.autoUnmask},isComplete:function(){return maskScope({'action':'isComplete','el':this.el},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},getmetadata:function(){return maskScope({'action':'getmetadata'},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},isValid:function(value){return maskScope({'action':'isValid','value':value},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)},format:function(value,metadata){return maskScope({'action':'format','value':value,'metadata':metadata},this.maskset||generateMaskSet(this.opts,this.noMasksCache),this.opts)}};Inputmask.extendDefaults=function(options){$.extend(true,Inputmask.prototype.defaults,options)};Inputmask.extendDefinitions=function(definition){$.extend(true,Inputmask.prototype.defaults.definitions,definition)};Inputmask.extendAliases=function(alias){$.extend(true,Inputmask.prototype.defaults.aliases,alias)};Inputmask.format=function(value,options,metadata){return Inputmask(options).format(value,metadata)};Inputmask.unmask=function(value,options){return Inputmask(options).unmaskedvalue(value)};Inputmask.isValid=function(value,options){return Inputmask(options).isValid(value)};Inputmask.remove=function(elems){$.each(elems,function(ndx,el){if(el.inputmask)el.inputmask.remove()})};Inputmask.escapeRegex=function(str){var specials=['/','.','*','+','?','|','(',')','[',']','{','}','\\','$','^'];return str.replace(new RegExp('(\\'+specials.join('|\\')+')','gim'),'\\$1')};Inputmask.keyCode={ALT:18,BACKSPACE:8,BACKSPACE_SAFARI:127,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91,X:88};function isInputEventSupported(eventName){var el=document.createElement('input'),evName='on'+eventName,isSupported=(evName in el);if(!isSupported){el.setAttribute(evName,'return;');isSupported=typeof el[evName]=='function'};el=null;return isSupported};function isElementTypeSupported(input,opts){var elementType=input.getAttribute('type'),isSupported=(input.tagName==='INPUT'&&$.inArray(elementType,opts.supportsInputType)!==-1)||input.isContentEditable||input.tagName==='TEXTAREA';if(!isSupported&&input.tagName==='INPUT'){var el=document.createElement('input');el.setAttribute('type',elementType);isSupported=el.type==='text';el=null};return isSupported};function resolveAlias(aliasStr,options,opts){var aliasDefinition=opts.aliases[aliasStr];if(aliasDefinition){if(aliasDefinition.alias)resolveAlias(aliasDefinition.alias,undefined,opts);$.extend(true,opts,aliasDefinition);$.extend(true,opts,options);return true}else if(opts.mask===null){opts.mask=aliasStr};return false};function importAttributeOptions(npt,opts,userOptions){var attrOptions=npt.getAttribute('data-inputmask'),option,dataoptions,optionData,p;function importOption(option,optionData){optionData=optionData!==undefined?optionData:npt.getAttribute('data-inputmask-'+option);if(optionData!==null){if(typeof optionData==='string'){if(option.indexOf('on')===0)optionData=window[optionData];else if(optionData==='false')optionData=false;else if(optionData==='true')optionData=true};userOptions[option]=optionData}};if(attrOptions&&attrOptions!==''){attrOptions=attrOptions.replace(new RegExp('\'','g'),'"');dataoptions=JSON.parse('{'+attrOptions+'}')};if(dataoptions){optionData=undefined;for(p in dataoptions){if(p.toLowerCase()==='alias'){optionData=dataoptions[p];break}}};importOption('alias',optionData);if(userOptions.alias){resolveAlias(userOptions.alias,userOptions,opts)};for(option in opts){if(dataoptions){optionData=undefined;for(p in dataoptions){if(p.toLowerCase()===option.toLowerCase()){optionData=dataoptions[p];break}}};importOption(option,optionData)};$.extend(true,opts,userOptions);return opts};function generateMaskSet(opts,nocache){var ms;function analyseMask(mask){var tokenizer=/(?:[?*+]|\{[0-9\+\*]+(?:,[0-9\+\*]*)?\})|[^.?*+^${[]()|\\]+|./g,escaped=false,currentToken=new MaskToken(),match,m,openenings=[],maskTokens=[],openingToken,currentOpeningToken,alternator,lastMatch,groupToken;function MaskToken(isGroup,isOptional,isQuantifier,isAlternator){this.matches=[];this.isGroup=isGroup||false;this.isOptional=isOptional||false;this.isQuantifier=isQuantifier||false;this.isAlternator=isAlternator||false;this.quantifier={min:1,max:1}};function insertTestDefinition(mtoken,element,position){var maskdef=opts.definitions[element];position=position!==undefined?position:mtoken.matches.length;var prevMatch=mtoken.matches[position-1];if(maskdef&&!escaped){maskdef.placeholder=$.isFunction(maskdef.placeholder)?maskdef.placeholder(opts):maskdef.placeholder;var prevalidators=maskdef.prevalidator,prevalidatorsL=prevalidators?prevalidators.length:0;for(var i=1;i<maskdef.cardinality;i++){var prevalidator=prevalidatorsL>=i?prevalidators[i-1]:[],validator=prevalidator.validator,cardinality=prevalidator.cardinality;mtoken.matches.splice(position++,0,{fn:validator?typeof validator==='string'?new RegExp(validator):new function(){this.test=validator}:new RegExp('.'),cardinality:cardinality?cardinality:1,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element});prevMatch=mtoken.matches[position-1]};mtoken.matches.splice(position++,0,{fn:maskdef.validator?typeof maskdef.validator=='string'?new RegExp(maskdef.validator):new function(){this.test=maskdef.validator}:new RegExp('.'),cardinality:maskdef.cardinality,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==(maskdef.definitionSymbol||element),casing:maskdef.casing,def:maskdef.definitionSymbol||element,placeholder:maskdef.placeholder,mask:element})}else{mtoken.matches.splice(position++,0,{fn:null,cardinality:0,optionality:mtoken.isOptional,newBlockMarker:prevMatch===undefined||prevMatch.def!==element,casing:null,def:opts.staticDefinitionSymbol||element,placeholder:opts.staticDefinitionSymbol!==undefined?element:undefined,mask:element});escaped=false}};function verifyGroupMarker(lastMatch,isOpenGroup){if(lastMatch.isGroup){lastMatch.isGroup=false;insertTestDefinition(lastMatch,opts.groupmarker.start,0);if(isOpenGroup!==true){insertTestDefinition(lastMatch,opts.groupmarker.end)}}};function maskCurrentToken(m,currentToken,lastMatch,extraCondition){if(currentToken.matches.length>0&&(extraCondition===undefined||extraCondition)){lastMatch=currentToken.matches[currentToken.matches.length-1];verifyGroupMarker(lastMatch)};insertTestDefinition(currentToken,m)};function defaultCase(){if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];maskCurrentToken(m,currentOpeningToken,lastMatch,!currentOpeningToken.isAlternator);if(currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++){alternator.matches[mndx].isGroup=false};if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(alternator)}else{currentToken.matches.push(alternator)}}}else{maskCurrentToken(m,currentToken,lastMatch)}};function reverseTokens(maskToken){function reverseStatic(st){if(st===opts.optionalmarker.start)st=opts.optionalmarker.end;else if(st===opts.optionalmarker.end)st=opts.optionalmarker.start;else if(st===opts.groupmarker.start)st=opts.groupmarker.end;else if(st===opts.groupmarker.end)st=opts.groupmarker.start;return st};maskToken.matches=maskToken.matches.reverse();for(var match in maskToken.matches){var intMatch=parseInt(match);if(maskToken.matches[match].isQuantifier&&maskToken.matches[intMatch+1]&&maskToken.matches[intMatch+1].isGroup){var qt=maskToken.matches[match];maskToken.matches.splice(match,1);maskToken.matches.splice(intMatch+1,0,qt)};if(maskToken.matches[match].matches!==undefined){maskToken.matches[match]=reverseTokens(maskToken.matches[match])}else{maskToken.matches[match]=reverseStatic(maskToken.matches[match])}};return maskToken}while(match=tokenizer.exec(mask)){m=match[0];if(escaped){defaultCase();continue};switch(m.charAt(0)){case opts.escapeChar:escaped=true;break;case opts.optionalmarker.end:case opts.groupmarker.end:openingToken=openenings.pop();if(openingToken!==undefined){if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(openingToken);if(currentOpeningToken.isAlternator){alternator=openenings.pop();for(var mndx=0;mndx<alternator.matches.length;mndx++){alternator.matches[mndx].isGroup=false};if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];currentOpeningToken.matches.push(alternator)}else{currentToken.matches.push(alternator)}}}else{currentToken.matches.push(openingToken)}}else defaultCase();break;case opts.optionalmarker.start:openenings.push(new MaskToken(false,true));break;case opts.groupmarker.start:openenings.push(new MaskToken(true));break;case opts.quantifiermarker.start:var quantifier=new MaskToken(false,false,true);m=m.replace(/[{}]/g,'');var mq=m.split(','),mq0=isNaN(mq[0])?mq[0]:parseInt(mq[0]),mq1=mq.length===1?mq0:(isNaN(mq[1])?mq[1]:parseInt(mq[1]));if(mq1==='*'||mq1==='+'){mq0=mq1==='*'?0:1};quantifier.quantifier={min:mq0,max:mq1};if(openenings.length>0){var matches=openenings[openenings.length-1].matches;match=matches.pop();if(!match.isGroup){groupToken=new MaskToken(true);groupToken.matches.push(match);match=groupToken};matches.push(match);matches.push(quantifier)}else{match=currentToken.matches.pop();if(!match.isGroup){groupToken=new MaskToken(true);groupToken.matches.push(match);match=groupToken};currentToken.matches.push(match);currentToken.matches.push(quantifier)};break;case opts.alternatormarker:if(openenings.length>0){currentOpeningToken=openenings[openenings.length-1];lastMatch=currentOpeningToken.matches.pop()}else{lastMatch=currentToken.matches.pop()};if(lastMatch.isAlternator){openenings.push(lastMatch)}else{alternator=new MaskToken(false,false,false,true);alternator.matches.push(lastMatch);openenings.push(alternator)};break;default:defaultCase()}}while(openenings.length>0){openingToken=openenings.pop();verifyGroupMarker(openingToken,true);currentToken.matches.push(openingToken)};if(currentToken.matches.length>0){lastMatch=currentToken.matches[currentToken.matches.length-1];verifyGroupMarker(lastMatch);maskTokens.push(currentToken)};if(opts.numericInput){reverseTokens(maskTokens[0])};return maskTokens};function generateMask(mask,metadata){if(mask===null||mask===''){return undefined}else{if(mask.length===1&&opts.greedy===false&&opts.repeat!==0){opts.placeholder=''};if(opts.repeat>0||opts.repeat==='*'||opts.repeat==='+'){var repeatStart=opts.repeat==='*'?0:(opts.repeat==='+'?1:opts.repeat);mask=opts.groupmarker.start+mask+opts.groupmarker.end+opts.quantifiermarker.start+repeatStart+','+opts.repeat+opts.quantifiermarker.end};var masksetDefinition;if(Inputmask.prototype.masksCache[mask]===undefined||nocache===true){masksetDefinition={'mask':mask,'maskToken':analyseMask(mask),'validPositions':{},'_buffer':undefined,'buffer':undefined,'tests':{},'metadata':metadata};if(nocache!==true){Inputmask.prototype.masksCache[opts.numericInput?mask.split('').reverse().join(''):mask]=masksetDefinition;masksetDefinition=$.extend(true,{},Inputmask.prototype.masksCache[opts.numericInput?mask.split('').reverse().join(''):mask])}}else masksetDefinition=$.extend(true,{},Inputmask.prototype.masksCache[opts.numericInput?mask.split('').reverse().join(''):mask]);return masksetDefinition}};function preProcessMask(mask){mask=mask.toString();return mask};if($.isFunction(opts.mask)){opts.mask=opts.mask(opts)};if($.isArray(opts.mask)){if(opts.mask.length>1){opts.keepStatic=opts.keepStatic===null?true:opts.keepStatic;var altMask='(';$.each(opts.numericInput?opts.mask.reverse():opts.mask,function(ndx,msk){if(altMask.length>1){altMask+=')|('};if(msk.mask!==undefined&&!$.isFunction(msk.mask)){altMask+=preProcessMask(msk.mask)}else{altMask+=preProcessMask(msk)}});altMask+=')';return generateMask(altMask,opts.mask)}else opts.mask=opts.mask.pop()};if(opts.mask){if(opts.mask.mask!==undefined&&!$.isFunction(opts.mask.mask)){ms=generateMask(preProcessMask(opts.mask.mask),opts.mask)}else{ms=generateMask(preProcessMask(opts.mask),opts.mask)}};return ms};var ua=navigator.userAgent,mobile=/mobile/i.test(ua),iemobile=/iemobile/i.test(ua),iphone=/iphone/i.test(ua)&&!iemobile;function maskScope(actionObj,maskset,opts){var isRTL=false,undoValue,el,$el,skipKeyPressEvent=false,skipInputEvent=false,ignorable=false,maxLength,mouseEnter=true;function getMaskTemplate(baseOnInput,minimalPos,includeInput){minimalPos=minimalPos||0;var maskTemplate=[],ndxIntlzr,pos=0,test,testPos,lvp=getLastValidPosition();maxLength=el!==undefined?el.maxLength:undefined;if(maxLength===-1)maxLength=undefined;do{if(baseOnInput===true&&getMaskSet().validPositions[pos]){var validPos=getMaskSet().validPositions[pos];test=validPos.match;ndxIntlzr=validPos.locator.slice();maskTemplate.push(includeInput===true?validPos.input:getPlaceholder(pos,test))}else{testPos=getTestTemplate(pos,ndxIntlzr,pos-1);test=testPos.match;ndxIntlzr=testPos.locator.slice();if(opts.jitMasking===false||pos<lvp||(isFinite(opts.jitMasking)&&opts.jitMasking>pos)){maskTemplate.push(getPlaceholder(pos,test))}};pos++}while((maxLength===undefined||pos<maxLength)&&(test.fn!==null||test.def!=='')||minimalPos>pos);if(maskTemplate[maskTemplate.length-1]===''){maskTemplate.pop()};getMaskSet().maskLength=pos+1;return maskTemplate};function getMaskSet(){return maskset};function resetMaskSet(soft){var maskset=getMaskSet();maskset.buffer=undefined;if(soft!==true){maskset._buffer=undefined;maskset.validPositions={};maskset.p=0}};function getLastValidPosition(closestTo,strict,validPositions){var before=-1,after=-1,valids=validPositions||getMaskSet().validPositions;if(closestTo===undefined)closestTo=-1;for(var posNdx in valids){var psNdx=parseInt(posNdx);if(valids[psNdx]&&(strict||valids[psNdx].match.fn!==null)){if(psNdx<=closestTo)before=psNdx;if(psNdx>=closestTo)after=psNdx}};return(before!==-1&&(closestTo-before)>1)||after<closestTo?before:after};function setValidPosition(pos,validTest,fromSetValid,isSelection){if(isSelection||(opts.insertMode&&getMaskSet().validPositions[pos]!==undefined&&fromSetValid===undefined)){var positionsClone=$.extend(true,{},getMaskSet().validPositions),lvp=getLastValidPosition(),i;for(i=pos;i<=lvp;i++){delete getMaskSet().validPositions[i]};getMaskSet().validPositions[pos]=validTest;var valid=true,j,vps=getMaskSet().validPositions,needsValidation=false;for(i=(j=pos);i<=lvp;i++){var t=positionsClone[i];if(t!==undefined){var posMatch=j,prevPosMatch=-1;while(posMatch<getMaskSet().maskLength&&((t.match.fn==null&&vps[i]&&(vps[i].match.optionalQuantifier===true||vps[i].match.optionality===true))||t.match.fn!=null)){if(t.match.fn===null||(!opts.keepStatic&&vps[i]&&(vps[i+1]!==undefined&&getTests(i+1,vps[i].locator.slice(),i).length>1||vps[i].alternation!==undefined))){posMatch++}else posMatch=seekNext(j);if(needsValidation===false&&positionsClone[posMatch]&&positionsClone[posMatch].match.def===t.match.def){getMaskSet().validPositions[posMatch]=$.extend(true,{},positionsClone[posMatch]);getMaskSet().validPositions[posMatch].input=t.input;j=posMatch;valid=true;break}else if(positionCanMatchDefinition(posMatch,t.match.def)){var result=isValid(posMatch,t.input,true,true);valid=result!==false;j=(result.caret||result.insert)?getLastValidPosition():posMatch;needsValidation=true;if(valid)break}else{valid=t.match.fn==null;if(prevPosMatch===posMatch)break;prevPosMatch=posMatch}}};if(!valid)break};if(!valid){getMaskSet().validPositions=$.extend(true,{},positionsClone);resetMaskSet(true);return false}}else getMaskSet().validPositions[pos]=validTest;resetMaskSet(true);return true};function stripValidPositions(start,end,nocheck,strict){function IsEnclosedStatic(pos){var posMatch=getMaskSet().validPositions[pos];if(posMatch!==undefined&&posMatch.match.fn===null){var prevMatch=getMaskSet().validPositions[pos-1],nextMatch=getMaskSet().validPositions[pos+1];return prevMatch!==undefined&&nextMatch!==undefined};return false};var i,startPos=start,positionsClone=$.extend(true,{},getMaskSet().validPositions),needsValidation=false;getMaskSet().p=start;for(i=end-1;i>=startPos;i--){if(getMaskSet().validPositions[i]!==undefined){if(nocheck===true||(!IsEnclosedStatic(i)&&opts.canClearPosition(getMaskSet(),i,getLastValidPosition(),strict,opts)!==false)){delete getMaskSet().validPositions[i]}}};resetMaskSet(true);for(i=startPos+1;i<=getLastValidPosition();){while(getMaskSet().validPositions[startPos]!==undefined)startPos++;var s=getMaskSet().validPositions[startPos];if(i<startPos)i=startPos+1;if((getMaskSet().validPositions[i]!==undefined||!isMask(i))&&s===undefined){var t=getTestTemplate(i);if(needsValidation===false&&positionsClone[startPos]&&positionsClone[startPos].match.def===t.match.def){getMaskSet().validPositions[startPos]=$.extend(true,{},positionsClone[startPos]);getMaskSet().validPositions[startPos].input=t.input;delete getMaskSet().validPositions[i];i++}else if(positionCanMatchDefinition(startPos,t.match.def)){if(isValid(startPos,t.input||getPlaceholder(i),true)!==false){delete getMaskSet().validPositions[i];i++;needsValidation=true}}else if(!isMask(i)){i++;startPos--};startPos++}else i++};resetMaskSet(true)};function determineTestTemplate(tests,ignoreGreedy){var testPos,testPositions=tests,lvp=getLastValidPosition(),lvTest=getMaskSet().validPositions[lvp]||getTests(0)[0],lvTestAltArr=(lvTest.alternation!==undefined)?lvTest.locator[lvTest.alternation].toString().split(','):[];for(var ndx=0;ndx<testPositions.length;ndx++){testPos=testPositions[ndx];if(testPos.match&&((((opts.greedy||ignoreGreedy)&&testPos.match.optionalQuantifier!==true)||(testPos.match.optionality===false||testPos.match.newBlockMarker===false)&&testPos.match.optionalQuantifier!==true)&&((lvTest.alternation===undefined||lvTest.alternation!==testPos.alternation)||(testPos.locator[lvTest.alternation]!==undefined&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(','),lvTestAltArr))))){break}};return testPos};function getTestTemplate(pos,ndxIntlzr,tstPs){return getMaskSet().validPositions[pos]||determineTestTemplate(getTests(pos,ndxIntlzr?ndxIntlzr.slice():ndxIntlzr,tstPs))};function getTest(pos){if(getMaskSet().validPositions[pos]){return getMaskSet().validPositions[pos]};return getTests(pos)[0]};function positionCanMatchDefinition(pos,def){var valid=false,tests=getTests(pos);for(var tndx=0;tndx<tests.length;tndx++){if(tests[tndx].match&&tests[tndx].match.def===def){valid=true;break}};return valid};function selectBestMatch(pos,alternateNdx){var bestMatch,indexPos;if(getMaskSet().tests[pos]||getMaskSet().validPositions[pos]){$.each(getMaskSet().tests[pos]||[getMaskSet().validPositions[pos]],function(ndx,lmnt){var ndxPos=lmnt.alternation?lmnt.locator[lmnt.alternation].toString().indexOf(alternateNdx):-1;if((indexPos===undefined||ndxPos<indexPos)&&ndxPos!==-1){bestMatch=lmnt;indexPos=ndxPos}})};return bestMatch};function getTests(pos,ndxIntlzr,tstPs){var maskTokens=getMaskSet().maskToken,testPos=ndxIntlzr?tstPs:0,ndxInitializer=ndxIntlzr?ndxIntlzr.slice():[0],matches=[],insertStop=false,latestMatch,cacheDependency=ndxIntlzr?ndxIntlzr.join(''):'';function resolveTestFromToken(maskToken,ndxInitializer,loopNdx,quantifierRecurse){function handleMatch(match,loopNdx,quantifierRecurse){function isFirstMatch(latestMatch,tokenGroup){var firstMatch=$.inArray(latestMatch,tokenGroup.matches)===0;if(!firstMatch){$.each(tokenGroup.matches,function(ndx,match){if(match.isQuantifier===true){firstMatch=isFirstMatch(latestMatch,tokenGroup.matches[ndx-1]);if(firstMatch)return false}})};return firstMatch};function resolveNdxInitializer(pos,alternateNdx){var bestMatch=selectBestMatch(pos,alternateNdx);return bestMatch?bestMatch.locator.slice(bestMatch.alternation+1):[]};if(testPos>10000){throw'Inputmask: There is probably an error in your mask definition or in the code. Create an issue on github with an example of the mask you are using. '+getMaskSet().mask;};if(testPos===pos&&match.matches===undefined){matches.push({'match':match,'locator':loopNdx.reverse(),'cd':cacheDependency});return true}else if(match.matches!==undefined){if(match.isGroup&&quantifierRecurse!==match){match=handleMatch(maskToken.matches[$.inArray(match,maskToken.matches)+1],loopNdx);if(match)return true}else if(match.isOptional){var optionalToken=match;match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse);if(match){latestMatch=matches[matches.length-1].match;if(isFirstMatch(latestMatch,optionalToken)){insertStop=true;testPos=pos}else return true}}else if(match.isAlternator){var alternateToken=match,malternateMatches=[],maltMatches,currentMatches=matches.slice(),loopNdxCnt=loopNdx.length,altIndex=ndxInitializer.length>0?ndxInitializer.shift():-1;if(altIndex===-1||typeof altIndex==='string'){var currentPos=testPos,ndxInitializerClone=ndxInitializer.slice(),altIndexArr=[],amndx;if(typeof altIndex=='string'){altIndexArr=altIndex.split(',')}else{for(amndx=0;amndx<alternateToken.matches.length;amndx++){altIndexArr.push(amndx)}};for(var ndx=0;ndx<altIndexArr.length;ndx++){amndx=parseInt(altIndexArr[ndx]);matches=[];ndxInitializer=resolveNdxInitializer(testPos,amndx);match=handleMatch(alternateToken.matches[amndx]||maskToken.matches[amndx],[amndx].concat(loopNdx),quantifierRecurse)||match;if(match!==true&&match!==undefined&&(altIndexArr[altIndexArr.length-1]<alternateToken.matches.length)){var ntndx=$.inArray(match,maskToken.matches)+1;if(maskToken.matches.length>ntndx){match=handleMatch(maskToken.matches[ntndx],[ntndx].concat(loopNdx.slice(1,loopNdx.length)),quantifierRecurse);if(match){altIndexArr.push(ntndx.toString());$.each(matches,function(ndx,lmnt){lmnt.alternation=loopNdx.length-1})}}};maltMatches=matches.slice();testPos=currentPos;matches=[];for(var i=0;i<ndxInitializerClone.length;i++){ndxInitializer[i]=ndxInitializerClone[i]};for(var ndx1=0;ndx1<maltMatches.length;ndx1++){var altMatch=maltMatches[ndx1],hasMatch=false;altMatch.alternation=altMatch.alternation||loopNdxCnt;for(var ndx2=0;ndx2<malternateMatches.length;ndx2++){var altMatch2=malternateMatches[ndx2];if(altMatch.match.def===altMatch2.match.def&&(typeof altIndex!=='string'||$.inArray(altMatch.locator[altMatch.alternation].toString(),altIndexArr)!==-1)){hasMatch=altMatch.match.mask===altMatch2.match.mask;if(altMatch2.locator[altMatch.alternation].toString().indexOf(altMatch.locator[altMatch.alternation])===-1){altMatch2.locator[altMatch.alternation]=altMatch2.locator[altMatch.alternation]+','+altMatch.locator[altMatch.alternation];altMatch2.alternation=altMatch.alternation};break}};if(!hasMatch){malternateMatches.push(altMatch)}}};if(typeof altIndex=='string'){malternateMatches=$.map(malternateMatches,function(lmnt,ndx){if(isFinite(ndx)){var mamatch,alternation=lmnt.alternation,altLocArr=lmnt.locator[alternation].toString().split(',');lmnt.locator[alternation]=undefined;lmnt.alternation=undefined;for(var alndx=0;alndx<altLocArr.length;alndx++){mamatch=$.inArray(altLocArr[alndx],altIndexArr)!==-1;if(mamatch){if(lmnt.locator[alternation]!==undefined){lmnt.locator[alternation]+=',';lmnt.locator[alternation]+=altLocArr[alndx]}else lmnt.locator[alternation]=parseInt(altLocArr[alndx]);lmnt.alternation=alternation}};if(lmnt.locator[alternation]!==undefined)return lmnt}})};matches=currentMatches.concat(malternateMatches);testPos=pos;insertStop=matches.length>0}else{match=handleMatch(alternateToken.matches[altIndex]||maskToken.matches[altIndex],[altIndex].concat(loopNdx),quantifierRecurse)};if(match)return true}else if(match.isQuantifier&&quantifierRecurse!==maskToken.matches[$.inArray(match,maskToken.matches)-1]){var qt=match;for(var qndx=(ndxInitializer.length>0)?ndxInitializer.shift():0;(qndx<(isNaN(qt.quantifier.max)?qndx+1:qt.quantifier.max))&&testPos<=pos;qndx++){var tokenGroup=maskToken.matches[$.inArray(qt,maskToken.matches)-1];match=handleMatch(tokenGroup,[qndx].concat(loopNdx),tokenGroup);if(match){latestMatch=matches[matches.length-1].match;latestMatch.optionalQuantifier=qndx>(qt.quantifier.min-1);if(isFirstMatch(latestMatch,tokenGroup)){if(qndx>(qt.quantifier.min-1)){insertStop=true;testPos=pos;break}else return true}else{return true}}}}else{match=resolveTestFromToken(match,ndxInitializer,loopNdx,quantifierRecurse);if(match)return true}}else testPos++};for(var tndx=(ndxInitializer.length>0?ndxInitializer.shift():0);tndx<maskToken.matches.length;tndx++){if(maskToken.matches[tndx].isQuantifier!==true){var match=handleMatch(maskToken.matches[tndx],[tndx].concat(loopNdx),quantifierRecurse);if(match&&testPos===pos){return match}else if(testPos>pos){break}}}};function mergeLocators(tests){var locator=[];if(!$.isArray(tests))tests=[tests];if(tests.length>0){if(tests[0].alternation===undefined){locator=determineTestTemplate(tests.slice()).locator.slice();if(locator.length===0)locator=tests[0].locator.slice()}else{$.each(tests,function(ndx,tst){if(tst.def!==''){if(locator.length===0)locator=tst.locator.slice();else{for(var i=0;i<locator.length;i++){if(tst.locator[i]&&locator[i].toString().indexOf(tst.locator[i])===-1){locator[i]+=','+tst.locator[i]}}}}})}};return locator};function filterTests(tests){if(false&&ndxIntlzr!==undefined){var temp=$.map(tests,function(test){var match=true;for(var i=0,ndxtl=tests.length,ndxil=ndxIntlzr?ndxIntlzr.length:0;i<ndxil;i++){if((typeof test.locator[i]==='string'&&!checkAlternationMatch(test.locator[i].split(','),ndxIntlzr[i].toString().split(',')))||(typeof test.locator[i]!=='string'&&(test.locator[i]<ndxIntlzr[i]&&(i!==ndxil-1||i!==ndxtl-1)))){match=false;break}};if(match){return test}});if(temp.length==0){console.log(JSON.stringify(tests))};return temp};return tests};if(pos>-1){if(ndxIntlzr===undefined){var previousPos=pos-1,test;while((test=getMaskSet().validPositions[previousPos]||getMaskSet().tests[previousPos])===undefined&&previousPos>-1){previousPos--};if(test!==undefined&&previousPos>-1){ndxInitializer=mergeLocators(test);cacheDependency=ndxInitializer.join('');testPos=previousPos}};if(getMaskSet().tests[pos]&&getMaskSet().tests[pos][0].cd===cacheDependency){return filterTests(getMaskSet().tests[pos])}else{};for(var mtndx=ndxInitializer.shift();mtndx<maskTokens.length;mtndx++){var match=resolveTestFromToken(maskTokens[mtndx],ndxInitializer,[mtndx]);if((match&&testPos===pos)||testPos>pos){break}}};if(matches.length===0||insertStop){matches.push({match:{fn:null,cardinality:0,optionality:true,casing:null,def:'',placeholder:''},locator:[],cd:cacheDependency})};if(ndxIntlzr!==undefined&&getMaskSet().tests[pos]){return $.extend(true,[],matches)};getMaskSet().tests[pos]=$.extend(true,[],matches);return getMaskSet().tests[pos]};function getBufferTemplate(){if(getMaskSet()._buffer===undefined){getMaskSet()._buffer=getMaskTemplate(false,1);if(getMaskSet().buffer===undefined){getMaskSet()._buffer.slice()}};return getMaskSet()._buffer};function getBuffer(noCache){if(getMaskSet().buffer===undefined||noCache===true){getMaskSet().buffer=getMaskTemplate(true,getLastValidPosition(),true)};return getMaskSet().buffer};function refreshFromBuffer(start,end,buffer){var i;if(start===true){resetMaskSet();start=0;end=buffer.length}else{for(i=start;i<end;i++){delete getMaskSet().validPositions[i]}};for(i=start;i<end;i++){resetMaskSet(true);if(buffer[i]!==opts.skipOptionalPartCharacter){isValid(i,buffer[i],true,true)}}};function casing(elem,test,pos){switch(test.casing){case'upper':elem=elem.toUpperCase();break;case'lower':elem=elem.toLowerCase();break;case'title':var posBefore=getMaskSet().validPositions[pos-1];if(pos===0||posBefore&&posBefore.input===String.fromCharCode(Inputmask.keyCode.SPACE)){elem=elem.toUpperCase()}else{elem=elem.toLowerCase()};break};return elem};function checkAlternationMatch(altArr1,altArr2){var altArrC=opts.greedy?altArr2:altArr2.slice(0,1),isMatch=false;for(var alndx=0;alndx<altArr1.length;alndx++){if($.inArray(altArr1[alndx],altArrC)!==-1){isMatch=true;break}};return isMatch};function isValid(pos,c,strict,fromSetValid){function isSelection(posObj){return isRTL?(posObj.begin-posObj.end)>1||((posObj.begin-posObj.end)===1&&opts.insertMode):(posObj.end-posObj.begin)>1||((posObj.end-posObj.begin)===1&&opts.insertMode)};strict=strict===true;var maskPos=pos;if(pos.begin!==undefined){maskPos=isRTL&&!isSelection(pos)?pos.end:pos.begin};function _isValid(position,c,strict,fromSetValid){var rslt=false;$.each(getTests(position),function(ndx,tst){var test=tst.match,loopend=c?1:0,chrs='';for(var i=test.cardinality;i>loopend;i--){chrs+=getBufferElement(position-(i-1))};if(c){chrs+=c};getBuffer(true);rslt=test.fn!=null?test.fn.test(chrs,getMaskSet(),position,strict,opts,isSelection(pos)):(c===test.def||c===opts.skipOptionalPartCharacter)&&test.def!==''?{c:test.placeholder||test.def,pos:position}:false;if(rslt!==false){var elem=rslt.c!==undefined?rslt.c:c;elem=(elem===opts.skipOptionalPartCharacter&&test.fn===null)?(test.placeholder||test.def):elem;var validatedPos=position,possibleModifiedBuffer=getBuffer();if(rslt.remove!==undefined){if(!$.isArray(rslt.remove))rslt.remove=[rslt.remove];$.each(rslt.remove.sort(function(a,b){return b-a}),function(ndx,lmnt){stripValidPositions(lmnt,lmnt+1,true)})};if(rslt.insert!==undefined){if(!$.isArray(rslt.insert))rslt.insert=[rslt.insert];$.each(rslt.insert.sort(function(a,b){return a-b}),function(ndx,lmnt){isValid(lmnt.pos,lmnt.c,false,fromSetValid)})};if(rslt.refreshFromBuffer){var refresh=rslt.refreshFromBuffer;strict=true;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,possibleModifiedBuffer);if(rslt.pos===undefined&&rslt.c===undefined){rslt.pos=getLastValidPosition();return false};validatedPos=rslt.pos!==undefined?rslt.pos:position;if(validatedPos!==position){rslt=$.extend(rslt,isValid(validatedPos,elem,true,fromSetValid));return false}}else if(rslt!==true&&rslt.pos!==undefined&&rslt.pos!==position){validatedPos=rslt.pos;refreshFromBuffer(position,validatedPos,getBuffer().slice());if(validatedPos!==position){rslt=$.extend(rslt,isValid(validatedPos,elem,true));return false}};if(rslt!==true&&rslt.pos===undefined&&rslt.c===undefined){return false};if(ndx>0){resetMaskSet(true)};if(!setValidPosition(validatedPos,$.extend({},tst,{'input':casing(elem,test,validatedPos)}),fromSetValid,isSelection(pos))){rslt=false};return false}});return rslt};function alternate(pos,c,strict,fromSetValid){var validPsClone=$.extend(true,{},getMaskSet().validPositions),lastAlt,alternation,isValidRslt,altPos,i,validPos;for(var lAlt=getLastValidPosition();lAlt>=0;lAlt--){altPos=getMaskSet().validPositions[lAlt];if(altPos&&altPos.alternation!==undefined){lastAlt=lAlt;alternation=getMaskSet().validPositions[lastAlt].alternation;if(getTestTemplate(lastAlt).locator[altPos.alternation]!==altPos.locator[altPos.alternation]){break}}};if(alternation!==undefined){lastAlt=parseInt(lastAlt);for(var decisionPos in getMaskSet().validPositions){decisionPos=parseInt(decisionPos);altPos=getMaskSet().validPositions[decisionPos];if(decisionPos>=lastAlt&&altPos.alternation!==undefined){var altNdxs;if(lastAlt===0){altNdxs=[];$.each(getMaskSet().tests[lastAlt],function(ndx,test){if(test.locator[alternation]!==undefined){altNdxs=altNdxs.concat(test.locator[alternation].toString().split(','))}})}else{altNdxs=getMaskSet().validPositions[lastAlt].locator[alternation].toString().split(',')};var decisionTaker=altPos.locator[alternation]!==undefined?altPos.locator[alternation]:altNdxs[0];if(decisionTaker.length>0){decisionTaker=decisionTaker.split(',')[0]};for(var mndx=0;mndx<altNdxs.length;mndx++){var validInputs=[],staticInputsBeforePos=0,staticInputsBeforePosAlternate=0;if(decisionTaker<altNdxs[mndx]){var possibilityPos,possibilities;for(var dp=decisionPos;dp>=0;dp--){possibilityPos=getMaskSet().validPositions[dp];if(possibilityPos!==undefined){var bestMatch=selectBestMatch(dp,altNdxs[mndx]);if(getMaskSet().validPositions[dp].match.def!==bestMatch.match.def){if(getMaskSet().validPositions[dp].generatedInput!==true){validInputs.push(getMaskSet().validPositions[dp].input)};getMaskSet().validPositions[dp]=bestMatch;getMaskSet().validPositions[dp].input=getPlaceholder(dp);if(getMaskSet().validPositions[dp].match.fn===null){staticInputsBeforePosAlternate++};possibilityPos=bestMatch};possibilities=possibilityPos.locator[alternation];possibilityPos.locator[alternation]=parseInt(altNdxs[mndx]);break}};if(decisionTaker!==possibilityPos.locator[alternation]){for(i=decisionPos+1;i<getLastValidPosition(undefined,true)+1;i++){validPos=getMaskSet().validPositions[i];if(validPos&&validPos.match.fn!=null){validInputs.push(validPos.input)}else if(i<pos)staticInputsBeforePos++;delete getMaskSet().validPositions[i]};resetMaskSet(true);opts.keepStatic=!opts.keepStatic;isValidRslt=true;while(validInputs.length>0){var input=validInputs.shift();if(input!==opts.skipOptionalPartCharacter){if(!(isValidRslt=isValid(getLastValidPosition(undefined,true)+1,input,false,fromSetValid))){break}}};possibilityPos.alternation=alternation;possibilityPos.locator[alternation]=possibilities;if(isValidRslt){var targetLvp=getLastValidPosition(pos)+1;for(i=decisionPos+1;i<getLastValidPosition()+1;i++){validPos=getMaskSet().validPositions[i];if((validPos===undefined||validPos.match.fn==null)&&i<pos){staticInputsBeforePosAlternate++}};pos=pos+(staticInputsBeforePosAlternate-staticInputsBeforePos);isValidRslt=isValid(pos>targetLvp?targetLvp:pos,c,strict,fromSetValid)};opts.keepStatic=!opts.keepStatic;if(!isValidRslt){resetMaskSet();getMaskSet().validPositions=$.extend(true,{},validPsClone)}else return isValidRslt}}};break}}};return false};function trackbackAlternations(originalPos,newPos){var vp=getMaskSet().validPositions[newPos],targetLocator=vp.locator,tll=targetLocator.length;for(var ps=originalPos;ps<newPos;ps++){if(getMaskSet().validPositions[ps]===undefined&&!isMask(ps,true)){var tests=getTests(ps),bestMatch=tests[0],equality=-1;$.each(tests,function(ndx,tst){for(var i=0;i<tll;i++){if(tst.locator[i]!==undefined&&checkAlternationMatch(tst.locator[i].toString().split(','),targetLocator[i].toString().split(','))){if(equality<i){equality=i;bestMatch=tst}}else break}});setValidPosition(ps,$.extend({},bestMatch,{'input':bestMatch.match.placeholder||bestMatch.match.def}),true)}}};var result=false,positionsClone=$.extend(true,{},getMaskSet().validPositions);for(var pndx=maskPos-1;pndx>-1;pndx--){if(getMaskSet().validPositions[pndx])break};var testTemplate,generatedPos;for(pndx++;pndx<maskPos;pndx++){if(getMaskSet().validPositions[pndx]===undefined&&(opts.jitMasking===false||opts.jitMasking>pndx)&&((testTemplate=getTestTemplate(pndx,getTestTemplate(pndx-1).locator,pndx-1)).match.def===opts.radixPointDefinitionSymbol||!isMask(pndx,true)||($.inArray(opts.radixPoint,getBuffer())<pndx&&testTemplate.match.fn&&testTemplate.match.fn.test(getPlaceholder(pndx),getMaskSet(),pndx,false,opts)))){result=_isValid(pndx,testTemplate.match.placeholder||(testTemplate.match.fn==null?testTemplate.match.def:(getPlaceholder(pndx)!==''?getPlaceholder(pndx):getBuffer()[pndx])),true,fromSetValid);if(result!==false){getMaskSet().validPositions[result.pos||pndx].generatedInput=true}}};if(isSelection(pos)){handleRemove(undefined,Inputmask.keyCode.DELETE,pos);maskPos=getMaskSet().p};if(maskPos<getMaskSet().maskLength){result=_isValid(maskPos,c,strict,fromSetValid);if((!strict||fromSetValid===true)&&result===false){var currentPosValid=getMaskSet().validPositions[maskPos];if(currentPosValid&&currentPosValid.match.fn===null&&(currentPosValid.match.def===c||c===opts.skipOptionalPartCharacter)){result={'caret':seekNext(maskPos)}}else if((opts.insertMode||getMaskSet().validPositions[seekNext(maskPos)]===undefined)&&!isMask(maskPos,true)){var testsFromPos=getTests(maskPos).slice();if(testsFromPos[testsFromPos.length-1].match.def==='')testsFromPos.pop();var staticChar=determineTestTemplate(testsFromPos,true);if(staticChar){staticChar=staticChar.match.placeholder||staticChar.match.def;_isValid(maskPos,staticChar,strict,fromSetValid)};for(var nPos=maskPos+1,snPos=seekNext(maskPos);nPos<=snPos;nPos++){result=_isValid(nPos,c,strict,fromSetValid);if(result!==false){trackbackAlternations(maskPos,nPos);maskPos=nPos;break}}}}};if(result===false&&opts.keepStatic){result=alternate(maskPos,c,strict,fromSetValid)};if(result===true){result={'pos':maskPos}};if($.isFunction(opts.postValidation)&&result!==false&&!strict&&fromSetValid!==true){result=opts.postValidation(getBuffer(true),result,opts)?result:false};if(result.pos===undefined){result.pos=maskPos};if(result===false){resetMaskSet(true);getMaskSet().validPositions=$.extend(true,{},positionsClone)};return result};function isMask(pos,strict){var test;if(strict){test=getTestTemplate(pos).match;if(test.def==='')test=getTest(pos).match}else test=getTest(pos).match;if(test.fn!=null){return test.fn}else if(strict!==true&&pos>-1&&!opts.keepStatic&&getMaskSet().validPositions[pos]===undefined){var tests=getTests(pos);return tests.length>2};return false};function seekNext(pos,newBlock){var maskL=getMaskSet().maskLength;if(pos>=maskL)return maskL;var position=pos;while(++position<maskL&&((newBlock===true&&(getTest(position).match.newBlockMarker!==true||!isMask(position)))||(newBlock!==true&&!isMask(position)))){};return position};function seekPrevious(pos,newBlock){var position=pos;if(position<=0)return 0;while(--position>0&&((newBlock===true&&getTest(position).match.newBlockMarker!==true)||(newBlock!==true&&!isMask(position)&&getTests(position).length<2))){};return position};function getBufferElement(position){return getMaskSet().validPositions[position]===undefined?getPlaceholder(position):getMaskSet().validPositions[position].input};function writeBuffer(input,buffer,caretPos,event,triggerInputEvent){if(event&&$.isFunction(opts.onBeforeWrite)){var result=opts.onBeforeWrite(event,buffer,caretPos,opts);if(result){if(result.refreshFromBuffer){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,result.buffer||buffer);buffer=getBuffer(true)};if(caretPos!==undefined)caretPos=result.caret!==undefined?result.caret:caretPos}};input.inputmask._valueSet(buffer.join(''));if(caretPos!==undefined&&(event===undefined||event.type!=='blur')){caret(input,caretPos)};if(triggerInputEvent===true){skipInputEvent=true;$(input).trigger('input')}};function getPlaceholder(pos,test){test=test||getTest(pos).match;if(test.placeholder!==undefined){return test.placeholder}else if(test.fn===null){if(pos>-1&&!opts.keepStatic&&getMaskSet().validPositions[pos]===undefined){var tests=getTests(pos),staticAlternations=[],prevTest;if(tests.length>2){for(var i=0;i<tests.length;i++){if(tests[i].match.optionality!==true&&tests[i].match.optionalQuantifier!==true&&(tests[i].match.fn===null||(prevTest===undefined||tests[i].match.fn.test(prevTest.match.def,getMaskSet(),pos,true,opts)!==false))){staticAlternations.push(tests[i]);if(tests[i].match.fn===null)prevTest=tests[i];if(staticAlternations.length>1){if(new RegExp('[0-9a-bA-Z]').test(staticAlternations[0].match.def)){return opts.placeholder.charAt(pos%opts.placeholder.length)}}}}}};return test.def};return opts.placeholder.charAt(pos%opts.placeholder.length)};function checkVal(input,writeOut,strict,nptvl){var inputValue=nptvl.slice(),charCodes='',initialNdx=0,result;function isTemplateMatch(){var isMatch=false,charCodeNdx=getBufferTemplate().slice(initialNdx,seekNext(initialNdx)).join('').indexOf(charCodes);if(charCodeNdx!==-1&&!isMask(initialNdx)){isMatch=true;var bufferTemplateArr=getBufferTemplate().slice(initialNdx,initialNdx+charCodeNdx);for(var i=0;i<bufferTemplateArr.length;i++){if(bufferTemplateArr[i]!==' '){isMatch=false;break}}};return isMatch};resetMaskSet();getMaskSet().p=seekNext(-1);if(!strict){if(opts.autoUnmask!==true){var staticInput=getBufferTemplate().slice(0,seekNext(-1)).join(''),matches=inputValue.join('').match(new RegExp('^'+Inputmask.escapeRegex(staticInput),'g'));if(matches&&matches.length>0){inputValue.splice(0,matches.length*staticInput.length);initialNdx=seekNext(initialNdx)}}else{initialNdx=seekNext(initialNdx)}};$.each(inputValue,function(ndx,charCode){if(charCode!==undefined){var keypress=new $.Event('keypress');keypress.which=charCode.charCodeAt(0);charCodes+=charCode;var lvp=getLastValidPosition(undefined,true),lvTest=getMaskSet().validPositions[lvp],nextTest=getTestTemplate(lvp+1,lvTest?lvTest.locator.slice():undefined,lvp);if(!isTemplateMatch()||strict||opts.autoUnmask){var pos=strict?ndx:(nextTest.match.fn==null&&nextTest.match.optionality&&(lvp+1)<getMaskSet().p?lvp+1:getMaskSet().p);result=keypressEvent.call(input,keypress,true,false,strict,pos);initialNdx=pos+1;charCodes=''}else{result=keypressEvent.call(input,keypress,true,false,true,lvp+1)};if(!strict&&$.isFunction(opts.onBeforeWrite)){result=opts.onBeforeWrite(keypress,getBuffer(),result.forwardPosition,opts);if(result&&result.refreshFromBuffer){var refresh=result.refreshFromBuffer;refreshFromBuffer(refresh===true?refresh:refresh.start,refresh.end,result.buffer);resetMaskSet(true);if(result.caret){getMaskSet().p=result.caret}}}}});if(writeOut){writeBuffer(input,getBuffer(),document.activeElement===input?seekNext(getLastValidPosition(0)):undefined,new $.Event('checkval'))}};function unmaskedvalue(input){if(input&&input.inputmask===undefined){return input.value};var umValue=[],vps=getMaskSet().validPositions;for(var pndx in vps){if(vps[pndx].match&&vps[pndx].match.fn!=null){umValue.push(vps[pndx].input)}};var unmaskedValue=umValue.length===0?'':(isRTL?umValue.reverse():umValue).join('');if($.isFunction(opts.onUnMask)){var bufferValue=(isRTL?getBuffer().slice().reverse():getBuffer()).join('');unmaskedValue=(opts.onUnMask(bufferValue,unmaskedValue,opts)||unmaskedValue)};return unmaskedValue};function caret(input,begin,end,notranslate){function translatePosition(pos){if(notranslate!==true&&isRTL&&typeof pos==='number'&&(!opts.greedy||opts.placeholder!=='')){var bffrLght=getBuffer().join('').length;pos=bffrLght-pos};return pos};var range;if(typeof begin==='number'){begin=translatePosition(begin);end=translatePosition(end);end=(typeof end=='number')?end:begin;var scrollCalc=parseInt(((input.ownerDocument.defaultView||window).getComputedStyle?(input.ownerDocument.defaultView||window).getComputedStyle(input,null):input.currentStyle).fontSize)*end;input.scrollLeft=scrollCalc>input.scrollWidth?scrollCalc:0;if(!mobile&&opts.insertMode===false&&begin===end)end++;if(input.setSelectionRange){input.selectionStart=begin;input.selectionEnd=end}else if(window.getSelection){range=document.createRange();if(input.firstChild===undefined||input.firstChild===null){var textNode=document.createTextNode('');input.appendChild(textNode)};range.setStart(input.firstChild,begin<input.inputmask._valueGet().length?begin:input.inputmask._valueGet().length);range.setEnd(input.firstChild,end<input.inputmask._valueGet().length?end:input.inputmask._valueGet().length);range.collapse(true);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(range)}else if(input.createTextRange){range=input.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',begin);range.select()}}else{if(input.setSelectionRange){begin=input.selectionStart;end=input.selectionEnd}else if(window.getSelection){range=window.getSelection().getRangeAt(0);if(range.commonAncestorContainer.parentNode===input||range.commonAncestorContainer===input){begin=range.startOffset;end=range.endOffset}}else if(document.selection&&document.selection.createRange){range=document.selection.createRange();begin=0-range.duplicate().moveStart('character',-input.inputmask._valueGet().length);end=begin+range.text.length};return{'begin':translatePosition(begin),'end':translatePosition(end)}}};function determineLastRequiredPosition(returnDefinition){var buffer=getBuffer(),bl=buffer.length,pos,lvp=getLastValidPosition(),positions={},lvTest=getMaskSet().validPositions[lvp],ndxIntlzr=lvTest!==undefined?lvTest.locator.slice():undefined,testPos;for(pos=lvp+1;pos<buffer.length;pos++){testPos=getTestTemplate(pos,ndxIntlzr,pos-1);ndxIntlzr=testPos.locator.slice();positions[pos]=$.extend(true,{},testPos)};var lvTestAlt=lvTest&&lvTest.alternation!==undefined?lvTest.locator[lvTest.alternation]:undefined;for(pos=bl-1;pos>lvp;pos--){testPos=positions[pos];if((testPos.match.optionality||testPos.match.optionalQuantifier||(lvTestAlt&&((lvTestAlt!==positions[pos].locator[lvTest.alternation]&&testPos.match.fn!=null)||(testPos.match.fn===null&&testPos.locator[lvTest.alternation]&&checkAlternationMatch(testPos.locator[lvTest.alternation].toString().split(','),lvTestAlt.toString().split(','))&&getTests(pos)[0].def!==''))))&&buffer[pos]===getPlaceholder(pos,testPos.match)){bl--}else break};return returnDefinition?{'l':bl,'def':positions[bl]?positions[bl].match:undefined}:bl};function clearOptionalTail(buffer){var rl=determineLastRequiredPosition(),lmib=buffer.length-1;for(;lmib>rl;lmib--){if(isMask(lmib))break};buffer.splice(rl,lmib+1-rl);return buffer};function isComplete(buffer){if($.isFunction(opts.isComplete))return opts.isComplete(buffer,opts);if(opts.repeat==='*')return undefined;var complete=false,lrp=determineLastRequiredPosition(true),aml=seekPrevious(lrp.l);if(lrp.def===undefined||lrp.def.newBlockMarker||lrp.def.optionality||lrp.def.optionalQuantifier){complete=true;for(var i=0;i<=aml;i++){var test=getTestTemplate(i).match;if((test.fn!==null&&getMaskSet().validPositions[i]===undefined&&test.optionality!==true&&test.optionalQuantifier!==true)||(test.fn===null&&buffer[i]!==getPlaceholder(i,test))){complete=false;break}}};return complete};var EventRuler={on:function(input,eventName,eventHandler){var ev=function(e){if(this.inputmask===undefined&&this.nodeName!=='FORM'){var imOpts=$.data(this,'_inputmask_opts');if(imOpts)(new Inputmask(imOpts)).mask(this);else EventRuler.off(this)}else if(e.type!=='setvalue'&&(this.disabled||(this.readOnly&&!(e.type==='keydown'&&(e.ctrlKey&&e.keyCode===67)||(opts.tabThrough===false&&e.keyCode===Inputmask.keyCode.TAB))))){e.preventDefault()}else{switch(e.type){case'input':if(skipInputEvent===true){skipInputEvent=false;return e.preventDefault()};break;case'keydown':skipKeyPressEvent=false;skipInputEvent=false;break;case'keypress':if(skipKeyPressEvent===true){return e.preventDefault()};skipKeyPressEvent=true;break;case'click':if(iemobile){var that=this;setTimeout(function(){eventHandler.apply(that,arguments)},0);return false};break};var returnVal=eventHandler.apply(this,arguments);if(returnVal===false){e.preventDefault();e.stopPropagation()};return returnVal}};input.inputmask.events[eventName]=input.inputmask.events[eventName]||[];input.inputmask.events[eventName].push(ev);if($.inArray(eventName,['submit','reset'])!==-1){if(input.form!=null)$(input.form).on(eventName,ev)}else{$(input).on(eventName,ev)}},off:function(input,event){if(input.inputmask&&input.inputmask.events){var events;if(event){events=[];events[event]=input.inputmask.events[event]}else{events=input.inputmask.events};$.each(events,function(eventName,evArr){while(evArr.length>0){var ev=evArr.pop();if($.inArray(eventName,['submit','reset'])!==-1){if(input.form!=null)$(input.form).off(eventName,ev)}else{$(input).off(eventName,ev)}};delete input.inputmask.events[eventName]})}}};function patchValueProperty(npt){var valueGet,valueSet;function patchValhook(type){if($.valHooks&&($.valHooks[type]===undefined||$.valHooks[type].inputmaskpatch!==true)){var valhookGet=$.valHooks[type]&&$.valHooks[type].get?$.valHooks[type].get:function(elem){return elem.value},valhookSet=$.valHooks[type]&&$.valHooks[type].set?$.valHooks[type].set:function(elem,value){elem.value=value;return elem};$.valHooks[type]={get:function(elem){if(elem.inputmask){if(elem.inputmask.opts.autoUnmask){return elem.inputmask.unmaskedvalue()}else{var result=valhookGet(elem);return getLastValidPosition(undefined,undefined,elem.inputmask.maskset.validPositions)!==-1||opts.nullable!==true?result:''}}else return valhookGet(elem)},set:function(elem,value){var $elem=$(elem),result;result=valhookSet(elem,value);if(elem.inputmask){$elem.trigger('setvalue')};return result},inputmaskpatch:true}}};function getter(){if(this.inputmask){return this.inputmask.opts.autoUnmask?this.inputmask.unmaskedvalue():(getLastValidPosition()!==-1||opts.nullable!==true?(document.activeElement===this&&opts.clearMaskOnLostFocus?(isRTL?clearOptionalTail(getBuffer().slice()).reverse():clearOptionalTail(getBuffer().slice())).join(''):valueGet.call(this)):'')}else return valueGet.call(this)};function setter(value){valueSet.call(this,value);if(this.inputmask){$(this).trigger('setvalue')}};function installNativeValueSetFallback(npt){EventRuler.on(npt,'mouseenter',function(event){var $input=$(this),input=this,value=input.inputmask._valueGet();if(value!==getBuffer().join('')){$input.trigger('setvalue')}})};if(!npt.inputmask.__valueGet){if(Object.getOwnPropertyDescriptor){if(typeof Object.getPrototypeOf!=='function'){Object.getPrototypeOf=typeof'test'.__proto__==='object'?function(object){return object.__proto__}:function(object){return object.constructor.prototype}};var valueProperty=Object.getPrototypeOf?Object.getOwnPropertyDescriptor(Object.getPrototypeOf(npt),'value'):undefined;if(valueProperty&&valueProperty.get&&valueProperty.set){valueGet=valueProperty.get;valueSet=valueProperty.set;Object.defineProperty(npt,'value',{get:getter,set:setter,configurable:true})}else if(npt.tagName!=='INPUT'){valueGet=function(){return this.textContent};valueSet=function(value){this.textContent=value};Object.defineProperty(npt,'value',{get:getter,set:setter,configurable:true})}}else if(document.__lookupGetter__&&npt.__lookupGetter__('value')){valueGet=npt.__lookupGetter__('value');valueSet=npt.__lookupSetter__('value');npt.__defineGetter__('value',getter);npt.__defineSetter__('value',setter)};npt.inputmask.__valueGet=valueGet;npt.inputmask._valueGet=function(overruleRTL){return isRTL&&overruleRTL!==true?valueGet.call(this.el).split('').reverse().join(''):valueGet.call(this.el)};npt.inputmask.__valueSet=valueSet;npt.inputmask._valueSet=function(value,overruleRTL){valueSet.call(this.el,(value===null||value===undefined)?'':((overruleRTL!==true&&isRTL)?value.split('').reverse().join(''):value))};if(valueGet===undefined){valueGet=function(){return this.value};valueSet=function(value){this.value=value};patchValhook(npt.type);installNativeValueSetFallback(npt)}}};function handleRemove(input,k,pos,strict){function generalize(){if(opts.keepStatic){resetMaskSet(true);var validInputs=[],lastAlt,positionsClone=$.extend(true,{},getMaskSet().validPositions);for(lastAlt=getLastValidPosition();lastAlt>=0;lastAlt--){var validPos=getMaskSet().validPositions[lastAlt];if(validPos){if(validPos.match.fn!=null){validInputs.push(validPos.input)};delete getMaskSet().validPositions[lastAlt];if(validPos.alternation!==undefined&&validPos.locator[validPos.alternation]===getTestTemplate(lastAlt).locator[validPos.alternation]){break}}};if(lastAlt>-1){while(validInputs.length>0){getMaskSet().p=seekNext(getLastValidPosition());var keypress=new $.Event('keypress');keypress.which=validInputs.pop().charCodeAt(0);keypressEvent.call(input,keypress,true,false,false,getMaskSet().p)}}else getMaskSet().validPositions=$.extend(true,{},positionsClone)}};if(opts.numericInput||isRTL){if(k===Inputmask.keyCode.BACKSPACE){k=Inputmask.keyCode.DELETE}else if(k===Inputmask.keyCode.DELETE){k=Inputmask.keyCode.BACKSPACE};if(isRTL){var pend=pos.end;pos.end=pos.begin;pos.begin=pend}};if(k===Inputmask.keyCode.BACKSPACE&&(pos.end-pos.begin<1||opts.insertMode===false)){pos.begin=seekPrevious(pos.begin);if(getMaskSet().validPositions[pos.begin]!==undefined&&(getMaskSet().validPositions[pos.begin].input===opts.groupSeparator||getMaskSet().validPositions[pos.begin].input===opts.radixPoint)){pos.begin--}}else if(k===Inputmask.keyCode.DELETE&&pos.begin===pos.end){pos.end=isMask(pos.end)?pos.end+1:seekNext(pos.end)+1;if(getMaskSet().validPositions[pos.begin]!==undefined&&(getMaskSet().validPositions[pos.begin].input===opts.groupSeparator||getMaskSet().validPositions[pos.begin].input===opts.radixPoint)){pos.end++}};stripValidPositions(pos.begin,pos.end,false,strict);if(strict!==true){generalize()};var lvp=getLastValidPosition(pos.begin);if(lvp<pos.begin){getMaskSet().p=seekNext(lvp)}else if(strict!==true){getMaskSet().p=pos.begin}};function keydownEvent(e){var input=this,$input=$(input),k=e.keyCode,pos=caret(input);if(k===Inputmask.keyCode.BACKSPACE||k===Inputmask.keyCode.DELETE||(iphone&&k===Inputmask.keyCode.BACKSPACE_SAFARI)||(e.ctrlKey&&k===Inputmask.keyCode.X&&!isInputEventSupported('cut'))){e.preventDefault();handleRemove(input,k,pos);writeBuffer(input,getBuffer(),getMaskSet().p,e,undoValue!==getBuffer().join(''));if(input.inputmask._valueGet()===getBufferTemplate().join('')){$input.trigger('cleared')}else if(isComplete(getBuffer())===true){$input.trigger('complete')};if(opts.showTooltip){input.title=opts.tooltip||getMaskSet().mask}}else if(k===Inputmask.keyCode.END||k===Inputmask.keyCode.PAGE_DOWN){e.preventDefault();var caretPos=seekNext(getLastValidPosition());if(!opts.insertMode&&caretPos===getMaskSet().maskLength&&!e.shiftKey)caretPos--;caret(input,e.shiftKey?pos.begin:caretPos,caretPos,true)}else if((k===Inputmask.keyCode.HOME&&!e.shiftKey)||k===Inputmask.keyCode.PAGE_UP){e.preventDefault();caret(input,0,e.shiftKey?pos.begin:0,true)}else if(((opts.undoOnEscape&&k===Inputmask.keyCode.ESCAPE)||(k===90&&e.ctrlKey))&&e.altKey!==true){checkVal(input,true,false,undoValue.split(''));$input.trigger('click')}else if(k===Inputmask.keyCode.INSERT&&!(e.shiftKey||e.ctrlKey)){opts.insertMode=!opts.insertMode;caret(input,!opts.insertMode&&pos.begin===getMaskSet().maskLength?pos.begin-1:pos.begin)}else if(opts.tabThrough===true&&k===Inputmask.keyCode.TAB){if(e.shiftKey===true){if(getTest(pos.begin).match.fn===null){pos.begin=seekNext(pos.begin)};pos.end=seekPrevious(pos.begin,true);pos.begin=seekPrevious(pos.end,true)}else{pos.begin=seekNext(pos.begin,true);pos.end=seekNext(pos.begin,true);if(pos.end<getMaskSet().maskLength)pos.end--};if(pos.begin<getMaskSet().maskLength){e.preventDefault();caret(input,pos.begin,pos.end)}}else if(opts.insertMode===false&&!e.shiftKey){if(k===Inputmask.keyCode.RIGHT){setTimeout(function(){var caretPos=caret(input);caret(input,caretPos.begin)},0)}else if(k===Inputmask.keyCode.LEFT){setTimeout(function(){var caretPos=caret(input);caret(input,isRTL?caretPos.begin+1:caretPos.begin-1)},0)}};opts.onKeyDown.call(this,e,getBuffer(),caret(input).begin,opts);ignorable=$.inArray(k,opts.ignorables)!==-1};function keypressEvent(e,checkval,writeOut,strict,ndx){var input=this,$input=$(input),k=e.which||e.charCode||e.keyCode;if(checkval!==true&&(!(e.ctrlKey&&e.altKey)&&(e.ctrlKey||e.metaKey||ignorable))){if(k===Inputmask.keyCode.ENTER&&undoValue!==getBuffer().join('')){undoValue=getBuffer().join('');setTimeout(function(){$input.trigger('change')},0)};return true}else{if(k){if(k===46&&e.shiftKey===false&&opts.radixPoint===',')k=44;var pos=checkval?{begin:ndx,end:ndx}:caret(input),forwardPosition,c=String.fromCharCode(k);getMaskSet().writeOutBuffer=true;var valResult=isValid(pos,c,strict);if(valResult!==false){var p=valResult.pos;resetMaskSet(true);if(valResult.caret!==undefined){forwardPosition=valResult.caret}else{var vps=getMaskSet().validPositions;if(!opts.keepStatic&&(vps[p+1]!==undefined&&getTests(p+1,vps[p].locator.slice(),p).length>1||vps[p].alternation!==undefined)){forwardPosition=p+1}else forwardPosition=seekNext(p)};getMaskSet().p=forwardPosition};if(writeOut!==false){var self=this;setTimeout(function(){opts.onKeyValidation.call(self,k,valResult,opts)},0);if(getMaskSet().writeOutBuffer&&valResult!==false){var buffer=getBuffer();writeBuffer(input,buffer,(opts.numericInput&&valResult.caret===undefined)?seekPrevious(forwardPosition):forwardPosition,e,checkval!==true);if(checkval!==true){setTimeout(function(){if(isComplete(buffer)===true)$input.trigger('complete')},0)}}};if(opts.showTooltip){input.title=opts.tooltip||getMaskSet().mask};e.preventDefault();if(checkval){valResult.forwardPosition=forwardPosition;return valResult}}}};function pasteEvent(e){var input=this,ev=e.originalEvent||e,$input=$(input),inputValue=input.inputmask._valueGet(true),caretPos=caret(input),tempValue;if(isRTL){tempValue=caretPos.end;caretPos.end=caretPos.begin;caretPos.begin=tempValue};var valueBeforeCaret=inputValue.substr(0,caretPos.begin),valueAfterCaret=inputValue.substr(caretPos.end,inputValue.length);if(valueBeforeCaret===(isRTL?getBufferTemplate().reverse():getBufferTemplate()).slice(0,caretPos.begin).join(''))valueBeforeCaret='';if(valueAfterCaret===(isRTL?getBufferTemplate().reverse():getBufferTemplate()).slice(caretPos.end).join(''))valueAfterCaret='';if(isRTL){tempValue=valueBeforeCaret;valueBeforeCaret=valueAfterCaret;valueAfterCaret=tempValue};if(window.clipboardData&&window.clipboardData.getData){inputValue=valueBeforeCaret+window.clipboardData.getData('Text')+valueAfterCaret}else if(ev.clipboardData&&ev.clipboardData.getData){inputValue=valueBeforeCaret+ev.clipboardData.getData('text/plain')+valueAfterCaret};var pasteValue=inputValue;if($.isFunction(opts.onBeforePaste)){pasteValue=opts.onBeforePaste(inputValue,opts);if(pasteValue===false){return e.preventDefault()};if(!pasteValue){pasteValue=inputValue}};checkVal(input,false,false,isRTL?pasteValue.split('').reverse():pasteValue.toString().split(''));writeBuffer(input,getBuffer(),seekNext(getLastValidPosition()),e,true);if(isComplete(getBuffer())===true){$input.trigger('complete')};return e.preventDefault()};function inputFallBackEvent(e){var input=this,inputValue=input.inputmask._valueGet();if(getBuffer().join('')!==inputValue){var caretPos=caret(input);inputValue=inputValue.replace(new RegExp('('+Inputmask.escapeRegex(getBufferTemplate().join(''))+')*'),'');if(iemobile){var inputChar=inputValue.replace(getBuffer().join(''),'');if(inputChar.length===1){var keypress=new $.Event('keypress');keypress.which=inputChar.charCodeAt(0);keypressEvent.call(input,keypress,true,true,false,getMaskSet().validPositions[caretPos.begin-1]?caretPos.begin:caretPos.begin-1);return false}};if(caretPos.begin>inputValue.length){caret(input,inputValue.length);caretPos=caret(input)};if((getBuffer().length-inputValue.length)===1&&inputValue.charAt(caretPos.begin)!==getBuffer()[caretPos.begin]&&inputValue.charAt(caretPos.begin+1)!==getBuffer()[caretPos.begin]&&!isMask(caretPos.begin)){e.keyCode=Inputmask.keyCode.BACKSPACE;keydownEvent.call(input,e)}else{var lvp=getLastValidPosition()+1,bufferTemplate=getBuffer().slice(lvp).join('');while(inputValue.match(Inputmask.escapeRegex(bufferTemplate)+'$')===null){bufferTemplate=bufferTemplate.slice(1)};inputValue=inputValue.replace(bufferTemplate,'');inputValue=inputValue.split('');checkVal(input,true,false,inputValue);if(isComplete(getBuffer())===true){$(input).trigger('complete')}};e.preventDefault()}};function setValueEvent(e){var input=this,value=input.inputmask._valueGet();checkVal(input,true,false,($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(value,opts)||value):value).split(''));undoValue=getBuffer().join('');if((opts.clearMaskOnLostFocus||opts.clearIncomplete)&&input.inputmask._valueGet()===getBufferTemplate().join('')){input.inputmask._valueSet('')}};function focusEvent(e){var input=this,nptValue=input.inputmask._valueGet();if(opts.showMaskOnFocus&&(!opts.showMaskOnHover||(opts.showMaskOnHover&&nptValue===''))){if(input.inputmask._valueGet()!==getBuffer().join('')){writeBuffer(input,getBuffer(),seekNext(getLastValidPosition()))}}else if(mouseEnter===false){caret(input,seekNext(getLastValidPosition()))};if(opts.positionCaretOnTab===true){setTimeout(function(){caret(input,seekNext(getLastValidPosition()))},0)};undoValue=getBuffer().join('')};function mouseleaveEvent(e){var input=this;mouseEnter=false;if(opts.clearMaskOnLostFocus&&document.activeElement!==input){var buffer=getBuffer().slice(),nptValue=input.inputmask._valueGet();if(nptValue!==input.getAttribute('placeholder')&&nptValue!==''){if(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join('')){buffer=[]}else{clearOptionalTail(buffer)};writeBuffer(input,buffer)}}};function clickEvent(e){function doRadixFocus(clickPos){if(opts.radixPoint!==''){var vps=getMaskSet().validPositions;if(vps[clickPos]===undefined||(vps[clickPos].input===getPlaceholder(clickPos))){if(clickPos<seekNext(-1))return true;var radixPos=$.inArray(opts.radixPoint,getBuffer());if(radixPos!==-1){for(var vp in vps){if(radixPos<vp&&vps[vp].input!==getPlaceholder(vp)){return false}};return true}}};return false};var input=this;setTimeout(function(){if(document.activeElement===input){var selectedCaret=caret(input);if(selectedCaret.begin===selectedCaret.end){switch(opts.positionCaretOnClick){case'none':break;case'radixFocus':if(doRadixFocus(selectedCaret.begin)){caret(input,opts.numericInput?seekNext($.inArray(opts.radixPoint,getBuffer())):$.inArray(opts.radixPoint,getBuffer()));break};default:var clickPosition=selectedCaret.begin,lvclickPosition=getLastValidPosition(clickPosition,true),lastPosition=seekNext(lvclickPosition);if(clickPosition<lastPosition){caret(input,!isMask(clickPosition)&&!isMask(clickPosition-1)?seekNext(clickPosition):clickPosition)}else{var placeholder=getPlaceholder(lastPosition);if((placeholder!==''&&getBuffer()[lastPosition]!==placeholder)||(!isMask(lastPosition,true)&&getTest(lastPosition).match.def===placeholder)){lastPosition=seekNext(lastPosition)};caret(input,lastPosition)};break}}}},0)};function dblclickEvent(e){var input=this;setTimeout(function(){caret(input,0,seekNext(getLastValidPosition()))},0)};function cutEvent(e){var input=this,$input=$(input),pos=caret(input),ev=e.originalEvent||e,clipboardData=window.clipboardData||ev.clipboardData,clipData=isRTL?getBuffer().slice(pos.end,pos.begin):getBuffer().slice(pos.begin,pos.end);clipboardData.setData('text',isRTL?clipData.reverse().join(''):clipData.join(''));if(document.execCommand)document.execCommand('copy');handleRemove(input,Inputmask.keyCode.DELETE,pos);writeBuffer(input,getBuffer(),getMaskSet().p,e,undoValue!==getBuffer().join(''));if(input.inputmask._valueGet()===getBufferTemplate().join('')){$input.trigger('cleared')};if(opts.showTooltip){input.title=opts.tooltip||getMaskSet().mask}};function blurEvent(e){var $input=$(this),input=this;if(input.inputmask){var nptValue=input.inputmask._valueGet(),buffer=getBuffer().slice();if(undoValue!==buffer.join('')){setTimeout(function(){$input.trigger('change');undoValue=buffer.join('')},0)};if(nptValue!==''){if(opts.clearMaskOnLostFocus){if(getLastValidPosition()===-1&&nptValue===getBufferTemplate().join('')){buffer=[]}else{clearOptionalTail(buffer)}};if(isComplete(buffer)===false){setTimeout(function(){$input.trigger('incomplete')},0);if(opts.clearIncomplete){resetMaskSet();if(opts.clearMaskOnLostFocus){buffer=[]}else{buffer=getBufferTemplate().slice()}}};writeBuffer(input,buffer,undefined,e)}}};function mouseenterEvent(e){var input=this;mouseEnter=true;if(document.activeElement!==input&&opts.showMaskOnHover){if(input.inputmask._valueGet()!==getBuffer().join('')){writeBuffer(input,getBuffer())}}};function submitEvent(e){if(undoValue!==getBuffer().join('')){$el.trigger('change')};if(opts.clearMaskOnLostFocus&&getLastValidPosition()===-1&&el.inputmask._valueGet&&el.inputmask._valueGet()===getBufferTemplate().join('')){el.inputmask._valueSet('')};if(opts.removeMaskOnSubmit){el.inputmask._valueSet(el.inputmask.unmaskedvalue(),true);setTimeout(function(){writeBuffer(el,getBuffer())},0)}};function resetEvent(e){setTimeout(function(){$el.trigger('setvalue')},0)};function mask(elem){el=elem;$el=$(el);if(opts.showTooltip){el.title=opts.tooltip||getMaskSet().mask};if(el.dir==='rtl'||opts.rightAlign){el.style.textAlign='right'};if(el.dir==='rtl'||opts.numericInput){el.dir='ltr';el.removeAttribute('dir');el.inputmask.isRTL=true;isRTL=true};EventRuler.off(el);patchValueProperty(el);if(isElementTypeSupported(el,opts)){EventRuler.on(el,'submit',submitEvent);EventRuler.on(el,'reset',resetEvent);EventRuler.on(el,'mouseenter',mouseenterEvent);EventRuler.on(el,'blur',blurEvent);EventRuler.on(el,'focus',focusEvent);EventRuler.on(el,'mouseleave',mouseleaveEvent);EventRuler.on(el,'click',clickEvent);EventRuler.on(el,'dblclick',dblclickEvent);EventRuler.on(el,'paste',pasteEvent);EventRuler.on(el,'dragdrop',pasteEvent);EventRuler.on(el,'drop',pasteEvent);EventRuler.on(el,'cut',cutEvent);EventRuler.on(el,'complete',opts.oncomplete);EventRuler.on(el,'incomplete',opts.onincomplete);EventRuler.on(el,'cleared',opts.oncleared);if(opts.inputEventOnly!==true){EventRuler.on(el,'keydown',keydownEvent);EventRuler.on(el,'keypress',keypressEvent)};EventRuler.on(el,'input',inputFallBackEvent)};EventRuler.on(el,'setvalue',setValueEvent);if(el.inputmask._valueGet()!==''||opts.clearMaskOnLostFocus===false||document.activeElement===el){var initialValue=$.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(el.inputmask._valueGet(),opts)||el.inputmask._valueGet()):el.inputmask._valueGet();checkVal(el,true,false,initialValue.split(''));var buffer=getBuffer().slice();undoValue=buffer.join('');if(isComplete(buffer)===false){if(opts.clearIncomplete){resetMaskSet()}};if(opts.clearMaskOnLostFocus&&document.activeElement!==el){if(getLastValidPosition()===-1){buffer=[]}else{clearOptionalTail(buffer)}};writeBuffer(el,buffer);if(document.activeElement===el){caret(el,seekNext(getLastValidPosition()))}}};var valueBuffer;if(actionObj!==undefined){switch(actionObj.action){case'isComplete':el=actionObj.el;return isComplete(getBuffer());case'unmaskedvalue':el=actionObj.el;if(el!==undefined&&el.inputmask!==undefined){maskset=el.inputmask.maskset;opts=el.inputmask.opts;isRTL=el.inputmask.isRTL}else{valueBuffer=actionObj.value;if(opts.numericInput){isRTL=true};valueBuffer=($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(valueBuffer,opts)||valueBuffer):valueBuffer).split('');checkVal(undefined,false,false,isRTL?valueBuffer.reverse():valueBuffer);if($.isFunction(opts.onBeforeWrite))opts.onBeforeWrite(undefined,getBuffer(),0,opts)};return unmaskedvalue(el);case'mask':el=actionObj.el;maskset=el.inputmask.maskset;opts=el.inputmask.opts;isRTL=el.inputmask.isRTL;undoValue=getBuffer().join('');mask(el);break;case'format':if(opts.numericInput){isRTL=true};valueBuffer=($.isFunction(opts.onBeforeMask)?(opts.onBeforeMask(actionObj.value,opts)||actionObj.value):actionObj.value).split('');checkVal(undefined,false,false,isRTL?valueBuffer.reverse():valueBuffer);if($.isFunction(opts.onBeforeWrite))opts.onBeforeWrite(undefined,getBuffer(),0,opts);if(actionObj.metadata){return{value:isRTL?getBuffer().slice().reverse().join(''):getBuffer().join(''),metadata:maskScope({'action':'getmetadata'},maskset,opts)}};return isRTL?getBuffer().slice().reverse().join(''):getBuffer().join('');case'isValid':if(opts.numericInput){isRTL=true};if(actionObj.value){valueBuffer=actionObj.value.split('');checkVal(undefined,false,true,isRTL?valueBuffer.reverse():valueBuffer)}else{actionObj.value=getBuffer().join('')};var buffer=getBuffer(),rl=determineLastRequiredPosition(),lmib=buffer.length-1;for(;lmib>rl;lmib--){if(isMask(lmib))break};buffer.splice(rl,lmib+1-rl);return isComplete(buffer)&&actionObj.value===getBuffer().join('');case'getemptymask':return getBufferTemplate().join('');case'remove':el=actionObj.el;$el=$(el);maskset=el.inputmask.maskset;opts=el.inputmask.opts;el.inputmask._valueSet(unmaskedvalue(el));EventRuler.off(el);var valueProperty;if(Object.getOwnPropertyDescriptor&&Object.getPrototypeOf){valueProperty=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(el),'value');if(valueProperty){if(el.inputmask.__valueGet){Object.defineProperty(el,'value',{get:el.inputmask.__valueGet,set:el.inputmask.__valueSet,configurable:true})}}}else if(document.__lookupGetter__&&el.__lookupGetter__('value')){if(el.inputmask.__valueGet){el.__defineGetter__('value',el.inputmask.__valueGet);el.__defineSetter__('value',el.inputmask.__valueSet)}};el.inputmask=undefined;break;case'getmetadata':if($.isArray(maskset.metadata)){var alternation,lvp=getLastValidPosition(undefined,true);for(var firstAlt=lvp;firstAlt>=0;firstAlt--){if(getMaskSet().validPositions[firstAlt]&&getMaskSet().validPositions[firstAlt].alternation!==undefined){alternation=getMaskSet().validPositions[firstAlt].alternation;break}};return alternation!==undefined?maskset.metadata[getMaskSet().validPositions[firstAlt].locator[alternation]]:[]};return maskset.metadata}}};window.Inputmask=Inputmask;return Inputmask}));(function(factory){if(typeof define==='function'&&define.amd){define(['jquery','inputmask'],factory)}else if(typeof exports==='object'){module.exports=factory(require('jquery'),require('./inputmask'))}else{factory(jQuery,window.Inputmask)}}(function($,Inputmask){if($.fn.inputmask===undefined){$.fn.inputmask=function(fn,options){var nptmask,input=this[0];if(options===undefined)options={};if(typeof fn==='string'){switch(fn){case'unmaskedvalue':return input&&input.inputmask?input.inputmask.unmaskedvalue():$(input).val();case'remove':return this.each(function(){if(this.inputmask)this.inputmask.remove()});case'getemptymask':return input&&input.inputmask?input.inputmask.getemptymask():'';case'hasMaskedValue':return input&&input.inputmask?input.inputmask.hasMaskedValue():false;case'isComplete':return input&&input.inputmask?input.inputmask.isComplete():true;case'getmetadata':return input&&input.inputmask?input.inputmask.getmetadata():undefined;case'setvalue':$(input).val(options);if(input&&input.inputmask===undefined){$(input).triggerHandler('setvalue')};break;case'option':if(typeof options==='string'){if(input&&input.inputmask!==undefined){return input.inputmask.option(options)}}else{return this.each(function(){if(this.inputmask!==undefined){return this.inputmask.option(options)}})};break;default:options.alias=fn;nptmask=new Inputmask(options);return this.each(function(){nptmask.mask(this)})}}else if(typeof fn=='object'){nptmask=new Inputmask(fn);if(fn.mask===undefined&&fn.alias===undefined){return this.each(function(){if(this.inputmask!==undefined){return this.inputmask.option(fn)}else nptmask.mask(this)})}else{return this.each(function(){nptmask.mask(this)})}}else if(fn===undefined){return this.each(function(){nptmask=new Inputmask(options);nptmask.mask(this)})}}};return $.fn.inputmask}));var fn={};function dd(data){console.log(data)};fn.loadCss=function(url){$('head').append('<link rel="stylesheet" href="'+url+'" type="text/css">')};fn.loadingHtml=function(box){var html='<div class="loading"><i class="fas fa-circle-notch fa-spin"></i></div>';box.empty().html(html)};fn.int=function(str,def){var int=parseInt(str);def=def?def:0;return isNaN(int)?def:int};fn.serializeArray=function(box){var data={};$('input, textarea, select',box).each(function(){var el=$(this),name=el.attr('name');if(!name){return};if(el.attr('type')=='checkbox'){if(el.is(':checked')){data[name]=data[name]||[];data[name].push(el.val())};return};data[name]=el.val()});return data};fn.price=function(price){price=new String(price);return price.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,'$1 ')};fn.scrollTo=function(el,duration,options){options=$.extend({offsetTop:-50,easing:'swing'},options);if(!duration){duration=600};$('html, body').animate({scrollTop:el.offset().top+options.offsetTop,},duration,options.easing)};var Url=function(){this.path='',this.get={},this.hash={},this.init=function(){var url={};var tmp=location.href.split('?');if(tmp[1]){tmp=tmp[1].split('#');url.get=tmp[0];url.hash=tmp[1]};url.hash=location.hash.substr(1);url.path='/'+tmp[0].replace(/^http:\/\/[a-zA-Z1-9\-\.]*\//,'');this.path=url.path;if(url.get){var getParams=url.get.split('&');for(i=0;i<getParams.length;i++){var tmp=getParams[i].split('=');this.get[tmp[0]]=tmp[1]}};if(url.hash){var hashParams=url.hash.split('&');for(i=0;i<hashParams.length;i++){var tmp=hashParams[i].split('=');this.hash[tmp[0]]=tmp[1]}};return this};this.setPath=function(path){this.path=path;return this};this.setParams=function(params,value){if(typeof params==='object'){this.get=$.extend(this.get,params)}else{this.get[params]=value};return this};this.getParams=function(key){if(key){return this.get[key]}else{return this.get}};this.clearParams=function(){this.get={};return this};this.setHash=function(params,value){if(typeof params==='object'){this.hash=$.extend(this.hash,params)}else{this.hash[params]=value};location.hash='#'+this.generateHash();return this};this.getHash=function(key){if(key){return this.hash[key]}else{return this.hash}};this.clearHash=function(){this.hash={};return this};this.generateParams=function(){var getParams='',first=true;$.each(this.get,function(key,val){getParams+=(first?'':'&');if($.isArray(val)){$.each(val,function(key2,val2){getParams+=(first?'':'&')+key+'='+val2;first=false})}else{getParams+=(first?'':'&')+key+'='+val};first=false});return getParams};this.generateHash=function(){var hashParams='',first=true;for(var param in this.hash){if(this.hash[param]){hashParams+=(first?'':'&')+param+'='+this.hash[param];first=false}};return hashParams};this.getUrl=function(){var url=this.path;if(getParams=this.generateParams()){url+='?'+getParams};if(hashParams=this.generateHash()){url+='#'+hashParams};return url};this.redirect=function(){location.href=this.getUrl()}};fn.url=function(){return new Url()};var Tabs=function(){this.el=null;this.options={historyMode:false,afterLoad:false};this.init=function(options){this.options=$.extend(this.options,options);var header=this.el.children('.tabs-header');this.el.find('.tab').each(function(){var tab=$(this);if(!tab.data('tab')){tab.attr('data-tab',(parseInt(tab.index()+1)))}});var tabs=this;header.find('.tab').on('click',function(){var tab=$(this);if(tab.prop('tagName')!='A'||tab.data('load')){tabs.setActive(tab);return false}});var active=header.children('.tab.active');if(!active.length){var tabName=fn.url().getHash(this.el.attr('data-name'));if(tabName){active=header.children('.tab[data-tab="'+tabName+'"]').addClass('active')}};if(!active.length){active=header.children('.tab:eq(0)').addClass('active')};tabs.setActive(active)};this.setActive=function(tab){var header=this.el.children('.tabs-header'),body=this.el.children('.tabs-body'),headerTab=header.find(tab),bodyTab=body.find('.tab[data-tab="'+tab.attr('data-tab')+'"]');if(!bodyTab.length){bodyTab=$('<div class="tab"></div>');bodyTab.attr('data-tab',tab.attr('data-tab'));bodyTab.appendTo(body)};if(headerTab.hasClass('active')&&!bodyTab.is(':empty')){bodyTab.addClass('active');return};headerTab.addClass('active').siblings().removeClass('active');bodyTab.addClass('active').siblings().removeClass('active');var options=this.options;if(headerTab.attr('data-load')){var url=headerTab.attr('data-load');if(this.options.historyMode){var disablePushState=this.options.disablePushState;$.ajax({url:url,dataType:'json',success:function(resp){bodyTab.html(resp.html);if(!disablePushState){History.replaceState({},resp.meta.title,url)};if(options.afterLoad){options.afterLoad()}}})}else{bodyTab.load(url,function(){headerTab.attr('data-load',null)})}};if(this.el.attr('data-name')){fn.url().setHash(this.el.attr('data-name'),headerTab.attr('data-tab'))}};this.setElement=function(el){this.el=el;return this}};$.fn.tabs=function(options){$(this).each(function(){var tabs=new Tabs();tabs.setElement($(this)).init(options)})};$.aptero=fn;jQuery.cookie=function(e,i,o){if('undefined'==typeof i){var n=null;if(document.cookie&&''!=document.cookie)for(var r=document.cookie.split(';'),t=0;t<r.length;t++){var p=jQuery.trim(r[t]);if(p.substring(0,e.length+1)==e+'='){n=decodeURIComponent(p.substring(e.length+1));break}};return n};o=o||{},null===i&&(i='',o.expires=-1);var u='';if(o.expires&&('number'==typeof o.expires||o.expires.toUTCString)){var s;'number'==typeof o.expires?(s=new Date,s.setTime(s.getTime()+24*o.expires*60*60*1e3)):s=o.expires,u='; expires='+s.toUTCString()};var a=o.path?'; path='+o.path:'',c=o.domain?'; domain='+o.domain:'',m=o.secure?'; secure':'';document.cookie=[e,'=',encodeURIComponent(i),u,a,c,m].join('')};var FormValidator=function(){this.form=null;this.options={autoValidate:false,before:false,after:false,fail:false,success:false,};this.setElement=function(form){this.form=form;return this};this.init=function(options){this.options=$.extend(this.options,options);$('input, select, textarea',this.form).on('change keyup',function(){var parent=$(this).parent();parent.removeClass('invalid');parent.find('.errors').remove()});return this};this.renderErrors=function(errors){if(!errors){return''};var html='<div class="errors">';$.each(errors,function(key,val){html+='<div class="error">'+val+'</div>'});html+='</div>';return html};this.checkErrors=function(form,options){options=$.extend({requestType:'submit',element:null,async:true},options);var result=false,data=form.serializeArray(),async=options.async;data.push({name:'requestType',value:options.requestType});var formV=this;$.ajax({type:'POST',async:async,url:form.attr('action'),data:data,dataType:'json',success:function(resp){if(!resp['errors']||!Object.keys(resp['errors']).length){form.find('.errors').remove();form.find('.invalid').removeClass('invalid');result=resp?resp:true;return};form.find('c').empty();$('.form-errors',form).empty();if(resp['errors']['form']){console.log(formV.renderErrors(resp['errors']['form']));$('.form-errors',form).append(formV.renderErrors(resp['errors']['form']))};form.find('input[type!="submit"][type!="hidden"], select, textarea').each(function(){var input=$(this),inputBox=$(this).parent(),errorsBox=inputBox.find('.errors'),errors=resp['errors'][input.attr('name')];if(!errors){errorsBox.remove();inputBox.removeClass('invalid')};if(options.element){if(options.element.attr('name')==input.attr('name')){errorsBox.remove();if(resp['errors'][input.attr('name')]){inputBox.addClass('invalid');inputBox.append(formV.renderErrors(errors))}else{inputBox.removeClass('invalid')}};return};errorsBox.remove();if(errors){inputBox.addClass('invalid');inputBox.append(formV.renderErrors(errors))}else{inputBox.removeClass('invalid')}})}});return result};this.formValidate=function(){return checkErrors($(this),{requestType:'validate',async:false})};this.submit=function(){var options=this.options,form=this.form,formV=this;this.form.on('submit',function(){if(options.before){options.before(form)};if(result=formV.checkErrors(form,{requestType:'submit',async:false})){if(options.success){options.success(result,form)}}else{if(options.fail){options.fail(result,form)}};if(options.after){options.after(result,form)};return false});return this}};$.fn.formSubmit=function(options){$(this).each(function(){var form=new FormValidator();form.setElement($(this)).init(options).submit()})};(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery'],factory)}else{factory(jQuery)}})(function($){'use strict';var instances=[],matchers=[],defaultOptions={precision:100,elapse:false,defer:false};matchers.push(/^[0-9]*$/.source);matchers.push(/([0-9]{1,2}\/){2}[0-9]{4}( [0-9]{1,2}(:[0-9]{2}){2})?/.source);matchers.push(/[0-9]{4}([\/\-][0-9]{1,2}){2}( [0-9]{1,2}(:[0-9]{2}){2})?/.source);matchers=new RegExp(matchers.join('|'));function parseDateString(dateString){if(dateString instanceof Date){return dateString};if(String(dateString).match(matchers)){if(String(dateString).match(/^[0-9]*$/)){dateString=Number(dateString)};if(String(dateString).match(/\-/)){dateString=String(dateString).replace(/\-/g,'/')};return new Date(dateString)}else{throw new Error('Couldn\'t cast `'+dateString+'` to a date object.');}};var DIRECTIVE_KEY_MAP={'Y':'years','m':'months','n':'daysToMonth','d':'daysToWeek','w':'weeks','W':'weeksToMonth','H':'hours','M':'minutes','S':'seconds','D':'totalDays','I':'totalHours','N':'totalMinutes','T':'totalSeconds'};function escapedRegExp(str){var sanitize=str.toString().replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1');return new RegExp(sanitize)};function strftime(offsetObject){return function(format){var directives=format.match(/%(-|!)?[A-Z]{1}(:[^;]+;)?/gi);if(directives){for(var i=0,len=directives.length;i<len;++i){var directive=directives[i].match(/%(-|!)?([a-zA-Z]{1})(:[^;]+;)?/),regexp=escapedRegExp(directive[0]),modifier=directive[1]||'',plural=directive[3]||'',value=null;directive=directive[2];if(DIRECTIVE_KEY_MAP.hasOwnProperty(directive)){value=DIRECTIVE_KEY_MAP[directive];value=Number(offsetObject[value])};if(value!==null){if(modifier==='!'){value=pluralize(plural,value)};if(modifier===''){if(value<10){value='0'+value.toString()}};format=format.replace(regexp,value.toString())}}};format=format.replace(/%%/,'%');return format}};function pluralize(format,count){var plural='s',singular='';if(format){format=format.replace(/(:|;|\s)/gi,'').split(/\,/);if(format.length===1){plural=format[0]}else{singular=format[0];plural=format[1]}};if(Math.abs(count)>1){return plural}else{return singular}};var Countdown=function(el,finalDate,options){this.el=el;this.$el=$(el);this.interval=null;this.offset={};this.options=$.extend({},defaultOptions);this.instanceNumber=instances.length;instances.push(this);this.$el.data('countdown-instance',this.instanceNumber);if(options){if(typeof options==='function'){this.$el.on('update.countdown',options);this.$el.on('stoped.countdown',options);this.$el.on('finish.countdown',options)}else{this.options=$.extend({},defaultOptions,options)}};this.setFinalDate(finalDate);if(this.options.defer===false){this.start()}};$.extend(Countdown.prototype,{start:function(){if(this.interval!==null){clearInterval(this.interval)};var self=this;this.update();this.interval=setInterval(function(){self.update.call(self)},this.options.precision)},stop:function(){clearInterval(this.interval);this.interval=null;this.dispatchEvent('stoped')},toggle:function(){if(this.interval){this.stop()}else{this.start()}},pause:function(){this.stop()},resume:function(){this.start()},remove:function(){this.stop.call(this);instances[this.instanceNumber]=null;delete this.$el.data().countdownInstance},setFinalDate:function(value){this.finalDate=parseDateString(value)},update:function(){if(this.$el.closest('html').length===0){this.remove();return};var hasEventsAttached=$._data(this.el,'events')!==undefined,now=new Date(),newTotalSecsLeft;newTotalSecsLeft=this.finalDate.getTime()-now.getTime();newTotalSecsLeft=Math.ceil(newTotalSecsLeft/1000);newTotalSecsLeft=!this.options.elapse&&newTotalSecsLeft<0?0:Math.abs(newTotalSecsLeft);if(this.totalSecsLeft===newTotalSecsLeft||!hasEventsAttached){return}else{this.totalSecsLeft=newTotalSecsLeft};this.elapsed=(now>=this.finalDate);this.offset={seconds:this.totalSecsLeft%60,minutes:Math.floor(this.totalSecsLeft/60)%60,hours:Math.floor(this.totalSecsLeft/60/60)%24,days:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToWeek:Math.floor(this.totalSecsLeft/60/60/24)%7,daysToMonth:Math.floor(this.totalSecsLeft/60/60/24%30.4368),weeks:Math.floor(this.totalSecsLeft/60/60/24/7),weeksToMonth:Math.floor(this.totalSecsLeft/60/60/24/7)%4,months:Math.floor(this.totalSecsLeft/60/60/24/30.4368),years:Math.abs(this.finalDate.getFullYear()-now.getFullYear()),totalDays:Math.floor(this.totalSecsLeft/60/60/24),totalHours:Math.floor(this.totalSecsLeft/60/60),totalMinutes:Math.floor(this.totalSecsLeft/60),totalSeconds:this.totalSecsLeft};if(!this.options.elapse&&this.totalSecsLeft===0){this.stop();this.dispatchEvent('finish')}else{this.dispatchEvent('update')}},dispatchEvent:function(eventName){var event=$.Event(eventName+'.countdown');event.finalDate=this.finalDate;event.elapsed=this.elapsed;event.offset=$.extend({},this.offset);event.strftime=strftime(this.offset);this.$el.trigger(event)}});$.fn.countdown=function(){var argumentsArray=Array.prototype.slice.call(arguments,0);return this.each(function(){var instanceNumber=$(this).data('countdown-instance');if(instanceNumber!==undefined){var instance=instances[instanceNumber],method=argumentsArray[0];if(Countdown.prototype.hasOwnProperty(method)){instance[method].apply(instance,argumentsArray.slice(1))}else if(String(method).match(/^[$A-Z_][0-9A-Z_$]*$/i)===null){instance.setFinalDate.call(instance,method);instance.start()}else{$.error('Method %s does not exist on jQuery.countdown'.replace(/\%s/gi,method))}}else{new Countdown(this,argumentsArray[0],argumentsArray[1])}})}});var $document=$(window);$(document).ready(function(){initNav();initElements($('body'));initAutocomplete();initDatepicker();initMetric()});function initMetric(){var url=$.aptero.url();url.init();$.ajax({url:'/metrics/init/',method:'post',data:{query:url.getParams(),source:'mobile'}})};function initNav(){var header=$('#header'),menu=$('.nav .menu','#header');$('.nav .trigger',header).on('click',function(){$(this).parent().toggleClass('open')});$('.nav .box',header).css({height:$document.height()-51});var menuH=0;$('.nav ul',header).each(function(){var ul=$(this);if(ul.outerHeight()>menuH){menuH=ul.outerHeight()}});$('.nav ul',header).css({height:menuH});$('a, span',menu).on('click',function(e){var li=$(this).closest('li');e.stopPropagation();if(li.hasClass('back')){li.parent().closest('li').removeClass('open').parent().removeClass('open');return false};if(li.children('ul').length){li.addClass('open').parent().addClass('open');return false};return true})};function initElements(box){$('.select-group',box).each(function(){var group=$(this),vals=$('span',group),input=$('input',group),setActive=function(val){if(input.val()==val){return};input.val(val).trigger('change');$('span[data-value="'+val+'"]',group).addClass('selected').siblings().removeClass('selected')};vals.on('click',function(){setActive($(this).data('value'))});var initVal=input.val()?input.val():vals.eq(0).data('value');input.val('');setActive(initVal)});$('.std-counter',box).each(function(){var el=$(this),input=$('input',el),incr=$('.incr',el),decr=$('.decr',el),maxNotice=incr.attr('title');function checkMinMax(){if(parseInt(input.val())>=parseInt(input.attr('max'))){incr.attr('title',maxNotice);incr.addClass('incr-max')}else{incr.attr('title','');incr.removeClass('incr-max')};if(parseInt(input.val())<=parseInt(input.attr('min'))){decr.addClass('decr-min')}else{decr.removeClass('decr-min')}};checkMinMax();incr.on('click',function(){var count=parseInt(input.val())+1,max=input.attr('max')?parseInt(input.attr('max')):999;if(count>max){return false};input.val(count);checkMinMax()});decr.on('click',function(){var count=parseInt(input.val())-1,min=input.attr('min')?parseInt(input.attr('min')):1;if(count<min){return false};input.val(count);checkMinMax()});var timer=null;$('.incr, .decr',el).on('click',function(){if(timer)clearTimeout(timer);setTimeout(function(){input.trigger('change')},150)})});$('.element',box).each(function(){$('input, textarea, select',$(this)).on('focus',function(){$(this).closest('.element').addClass('focus')}).on('focusout',function(){$(this).closest('.element').removeClass('focus')}).on('keyup',function(){var element=$(this).closest('.element');if($(this).val()){element.addClass('not-empty')}else{element.removeClass('not-empty')}}).trigger('keyup')});$('.popup',box).on('click',function(){var el=$(this);$.fancybox.open({src:el.attr('href'),type:'ajax',opts:{margin:[20,10],ajax:{settings:{data:el.data()}},afterLoad:function(e){initElements(e.$refs.slider)}}});return false})};function initAutocomplete(){var input=$('.search .query'),url='/catalog/search/';function stars(stars){var html='<div class="stars">';for($i=0;$i<=4;$i++){$starFilling=stars-$i;if($starFilling>=0.6){$class=' class="full"'}else if($starFilling>=0.1){$class=' class="half"'}else{$class=''};html+='<div'+$class+'></div> '};html+='</div>';return html};$.widget('custom.catcomplete',$.ui.autocomplete,{_create:function(){this._super();this.widget().menu('option','items','.ac-item');$('.add-to-cart').menu('option','disabled',true)},_renderItem:function(ul,item){var li=$('<li></li>');li.addClass('ac-item');switch(item.type){case'title':break;case'hr':li.addClass('ac-hr').removeClass('ac-item').text(item.label);break;case'clear':li.addClass('ac-clear').removeClass('ac-item').text(item.label);break;case'show-all':li.addClass('ac-show-all').removeClass('ac-item');li.append('<span>Показать еще</span>');li.on('click',function(){location.href=url+'?query='+input.val()});break;case'category':li.addClass('ac-category');li.append('<a href="'+item.url+'">'+item.label+'</a>');break;case'brand':li.addClass('ac-brand');li.append('<a href="'+item.url+'">'+item.label+'</a>');break;case'product':li.addClass('ac-product');li.append('<div class="pr-box"><div><a href="'+item.url+'" class="pic"><img src="'+item.img+'"></a><div class="info"><a href="'+item.url+'" class="title">'+item.label+'</a><div>'+stars(item.stars)+'<span class="reviews">'+item.reviews+'</span></div><span class="price"><span>от</span> '+$.aptero.price(item.price)+' <i class="fa fa-rub"></i></span> </div></div></div>');break;default:li.append('<a href="#">'+item.label+'</a>')};if(item.hide){li.addClass('hide').removeClass('ac-item')};return li.appendTo(ul)}});var pos={my:'left top',at:'left bottom'};input.catcomplete({position:pos,source:function(request,response){$.ajax({url:url,type:'get',dataType:'json',data:{query:request.term},success:function(data){response(data)}})},select:function(event,ui){if(ui.item.url){location.href=ui.item.url}},open:function(event,ui){$('.order-box .js-to-cart','.ac-product').on('click',function(e){var el=$(this);cart.add({id:el.data('id'),count:1});e.stopPropagation();return false})},lookup:'res',maxHeight:300,width:630,zIndex:9999,deferRequestBy:300,params:{limit:10},})};function initDatepicker(){$.config.datepicker={clearText:'Очистить',clearStatus:'',closeText:'Закрыть',closeStatus:'',prevText:'',prevStatus:'',nextText:'',nextStatus:'',currentText:'Сегодня',currentStatus:'',monthNames:['Январь','Февраль','Март','Апрель','Май','Июнь','Июль','Август','Сентябрь','Октябрь','Ноябрь','Декабрь'],monthNamesShort:['Янв','Фев','Мар','Апр','Май','Июн','Июл','Авг','Сен','Окт','Ноя','Дек'],monthStatus:'',yearStatus:'',weekHeader:'Не',weekStatus:'',dayNames:['воскресенье','понедельник','вторник','среда','четверг','пятница','суббота'],dayNamesShort:['вск','пнд','втр','срд','чтв','птн','сбт'],dayNamesMin:['Вс','Пн','Вт','Ср','Чт','Пт','Сб'],dayStatus:'DD',dateStatus:'D, M d',dateFormat:'dd.mm.yy',firstDay:1,initStatus:'',isRTL:false,minDate:+1,maxDate:+30,};$('.datepicker').datepicker($.config.datepicker)};var mapsArr=[];function setPickupMap(options){var map=null;$.each(mapsArr,function(key,val){if(val.id==options.id){val.map.destroy();mapsArr.splice(key,1)}});$.getScript(libs.libYandexMaps,function(){var data=options.pointsData?options.pointsData:{};var url=options.url?options.url:'/delivery/points-map-data/';$.ajax({url:url,method:'post',data:data,success:function(resp){options=$.extend(options,{center:resp.center,points:resp.points,});initMap(options)}})});var initMap=function(options){if(!options.center.lat||!options.center.lon){return};ymaps.ready(function(){map=new ymaps.Map(options.id,{center:[options.center.lat,options.center.lon],controls:[],zoom:(options.zoom?options.zoom:11)});var clusterer=new ymaps.Clusterer({preset:'twirl#invertedBlueClusterIcons',clusterDisableClickZoom:false,});var markers=[];options.points.forEach(function(point){var marker=new ymaps.Placemark([point.lat,point.lon],{balloonContent:point.desc},{preset:'islands#blackHomeIcon',});markers.push(marker);map.geoObjects.add(marker)});if(options.scrollZoom!==undefined&&options.scrollZoom==false){map.behaviors.disable('scrollZoom')};map.controls.add('zoomControl',{top:10,left:5});if(options.onInit){options.onInit()};mapsArr.push({id:options.id,map:map})})};return map};